<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Progress - OptiLife</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <style>
        :root {
            --bg-color: #000;
            --snd-bf-color: #111;
            --text-color: #fff;
            --main-color: #FFD700;
            --color-black: #0a0a0a;
            --color-dark-gray: #1a1a1a;
            --color-gold: #daa520;
            --color-gold-light: #f0c44c;
            --color-text-muted: #aaaaaa;
            --border-color-light: #333;
            --header-height-desktop: 100px;
            --header-height-mobile: 80px;
            --font-primary: 'Poppins', sans-serif;
            --card-bg: var(--color-dark-gray);
            --card-text-color: var(--text-color);
            --card-muted-text-color: var(--color-text-muted);
            --card-border-color: var(--border-color-light);
            --card-accent-color: var(--main-color);
            --grid-gap: 1.5rem;
            --content-padding: 1.5rem;
            --button-primary-bg: var(--main-color);
            --button-primary-text: var(--color-black);
            --button-primary-hover-bg: var(--color-gold-light); /* membership.html used transparent, progress used gold-light. Let's try to keep progress's default but apply specific hover for modal buttons if needed */
            --button-secondary-bg: #555;
            --button-secondary-text: var(--text-color);
            --button-secondary-hover-bg: #666;
            --modal-overlay-bg: rgba(0, 0, 0, 0.7);
            
            /* Modal specific vars from membership.html, adapted if needed */
            --modal-bg-dark: var(--color-dark-gray); /* Use progress.html's --modal-bg */
            --modal-text-dark: var(--text-color); /* Use progress.html's --modal-text-color */
            --input-bg-dark: #252525; /* Use progress.html's --input-bg */
            --error-color: #f44336;


            /* progress.html specific variables */
            --modal-bg: var(--color-dark-gray);
            --modal-text-color: var(--text-color);
            --input-bg: #252525;
            --input-border-color: var(--border-color-light);
            --input-text-color: var(--text-color);
            --input-focus-border-color: var(--main-color);
            --input-focus-shadow: rgba(255, 215, 0, 0.3);
            --table-header-bg: #252525;
            --table-row-even-bg: #222;
            --table-row-hover-bg: #303030;
            --table-border-color: var(--border-color-light);
            --chart-title-color: var(--text-color);
            --stat-card-icon-color: var(--main-color);
            --stat-card-value-color: var(--text-color);
            --stat-card-sub-increase: #4CAF50;
            --stat-card-sub-decrease: #f44336;
            --tab-inactive-bg: #333;
            --tab-inactive-text: var(--card-muted-text-color);
            --tab-hover-bg: #444;
            --tab-hover-text: var(--card-text-color);
        }
    
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
          text-decoration: none;
          list-style: none;
          border: none;
          outline: none;
        }
    
        html {
            font-size: 62.5%;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }
    
        body {
          background-color: var(--bg-color);
          color: var(--text-color);
          font-family: var(--font-primary);
          font-size: 1.6rem;
          line-height: 1.6;
          display: flex;
          flex-direction: column;
          min-height: 100vh;
        }
    
        img {
            max-width: 100%;
            height: auto;
            display: block;
        }
    
        header {
            position: fixed;
            width: 100%;
            height: var(--header-height-desktop);
            top: 0;
            left: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 9%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            transition: background 0.5s ease, backdrop-filter 0.5s ease, height 0.3s ease, padding 0.3s ease;
            box-sizing: border-box;
            border-bottom: 1px solid var(--border-color-light);
        }
    
        .logo {
            cursor: pointer;
            transition: 0.3s ease-in-out;
            flex-shrink: 0;
            display: flex;
            align-items: center;
        }
    
        .logo img {
            max-width: 100px;
            height: auto;
            transition: max-width 0.3s ease;
        }
    
        .logo:hover {
            transform: scale(1.05);
        }
    
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            list-style: none;
            padding: 0;
            margin: 0;
            flex-grow: 1;
            margin-left: 4rem;
            transition: left 0.3s ease-in-out, right 0.5s ease;
        }
    
        .navbar-left,
        .navbar-right {
            display: flex;
            align-items: center;
            padding: 0;
            margin: 0;
        }
        .navbar-right {
            gap: 2rem;
        }
    
        .navbar li {
            margin: 0;
            padding: 0;
            display: flex;
            align-items: center;
        }
    
        .navbar a {
            font-size: 1.8rem;
            font-weight: 500;
            color: var(--text-color);
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
            padding: 0.5rem 0;
        }
    
        .navbar-left li a {
            margin-left: 4rem;
        }
        .navbar-left li:first-child a {
            margin-left: 0;
        }
    
        .navbar-right .profile-menu-container {
            position: relative;
        }
    
        .welcome-text {
            font-size: 1.6rem;
            color: var(--color-text-muted);
            white-space: nowrap;
        }
        .welcome-text span#header-user-name {
            font-weight: 500;
            color: var(--text-color);
        }
    
        .navbar-right li a#logout-link {
            margin-left: 0;
            display: flex;
            align-items: center;
            gap: 0.6rem;
            border-bottom: none;
            padding: 0.5rem 0.8rem;
            border-radius: 4px;
        }
        .navbar-right li a#logout-link i {
            font-size: 2rem;
            line-height: 1;
            transition: color 0.3s ease;
        }
    
        .navbar a:hover,
        .navbar a.active {
            color: var(--main-color);
            border-bottom-color: var(--main-color);
        }
    
        .navbar-right li a#logout-link:hover {
            color: var(--main-color);
            border-bottom-color: transparent;
            background-color: rgba(255, 215, 0, 0.1);
        }
        .navbar-right li a#logout-link:hover i {
            color: var(--main-color);
        }
    
    
        .navbar .profile-pic {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            display: block;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, width 0.3s ease, height 0.3s ease;
            border: 2px solid transparent;
        }
        .navbar .profile-pic:hover {
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(var(--main-color), 0.5);
        }
         .navbar .profile-pic.active {
             border-color: var(--main-color);
             box-shadow: 0 0 10px rgba(var(--main-color), 0.5);
         }
    
        #menu-icon {
            font-size: 4.5rem;
            color: var(--main-color);
            cursor: pointer;
            display: none;
            margin-left: 2rem;
            z-index: 1001;
        }
    
         .profile-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 10px;
            background-color: var(--snd-bf-color);
            border: 1px solid var(--border-color-light);
            border-radius: 6px;
            min-width: 180px; /* Adjusted to fit longer item names */
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1100;
            padding: 0.5rem 0;
            list-style: none;
            animation: fadeInDropdown 0.2s ease-out;
        }
        .profile-dropdown.active { display: block; }
        @keyframes fadeInDropdown { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
    
        .profile-dropdown li a.dropdown-item {
            display: flex;
            align-items: center;
            padding: 0.8rem 1.5rem;
            font-size: 1.4rem;
            color: var(--text-color);
            font-weight: 400;
            white-space: nowrap;
            transition: background-color 0.2s ease, color 0.2s ease;
            border-bottom: none;
        }
        .profile-dropdown li a.dropdown-item:hover {
            background-color: var(--color-dark-gray);
            color: var(--main-color);
        }
        .profile-dropdown li a.dropdown-item i {
            margin-right: 0.8rem;
            font-size: 1.6rem;
            vertical-align: middle;
            position: relative;
            top: -1px;
            color: var(--color-text-muted);
            transition: color 0.2s ease;
        }
        .profile-dropdown li a.dropdown-item:hover i {
            color: var(--main-color);
        }
    
        main.content-grid {
            padding-top: calc(var(--header-height-desktop, 100px) + 2rem);
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: var(--grid-gap);
            padding-left: var(--content-padding);
            padding-right: var(--content-padding);
            padding-bottom: var(--content-padding);
            color: var(--card-text-color);
            transition: padding-top 0.3s ease;
            flex-grow: 1; /* Ensure main takes up space */
        }
    
        .card {
            background-color: var(--card-bg);
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--card-border-color);
            color: var(--card-text-color);
        }
    
        .calendar-widget {
             border: 2px solid var(--card-accent-color);
        }
    
        .calendar-widget h2 {
             color: var(--card-accent-color) !important;
             font-size: 1.7rem;
             margin-bottom: 1rem;
        }
        .calendar-widget .input-block label {
            color: var(--card-accent-color) !important;
            font-size: 1.3rem;
            display: block;
            margin-bottom: 0.5rem;
        }
    
    
        .calendar-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 1rem; font-weight: 500;
            color: var(--card-text-color);
            font-size: 1.4rem;
        }
        .cal-nav {
            border: 1px solid var(--card-border-color);
            color: var(--card-muted-text-color);
            padding: 0.3rem 0.8rem; border-radius: 4px; cursor: pointer; background: none;
            font-size: 1.4rem;
        }
        .cal-nav:hover {
            color: var(--card-accent-color);
            border-color: var(--card-accent-color);
        }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; text-align: center; margin-bottom: 1.5rem; }
        .day-name {
            font-weight: 600; font-size: 1.1rem;
            color: var(--card-muted-text-color);
            text-transform: uppercase;
        }
        .date-cell { display: flex; justify-content: center; align-items: center; aspect-ratio: 1 / 1; }
        .date-cell button {
            width: 100%; height: 100%; border-radius: 50%; border: 2px solid transparent; background-color: transparent;
            color: var(--card-text-color);
            cursor: pointer; font-size: 1.3rem;
            transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease; display: flex; align-items: center; justify-content: center; padding: 0;
        }
        .date-cell button:hover:not(.selected) {
            background-color: #333;
            border-color: var(--card-border-color);
        }
        .date-cell button.selected {
            background-color: var(--main-color);
            color: var(--color-black);
            font-weight: bold;
            border-color: var(--color-gold-light);
        }
        .date-cell.empty { visibility: hidden; }
    
        .calendar-widget .input-block { margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid var(--card-border-color); }
        .calendar-widget .input-block:last-child { border-bottom: none; padding-bottom: 0; margin-bottom: 0; }
        .calendar-widget .info-input {
            background-color: var(--input-bg);
            border: 1px solid var(--input-border-color);
            color: var(--input-text-color);
            font-size: 1.25rem;
            padding: 0.8rem 1rem; width: 100%; border-radius: 4px;
        }
        .calendar-widget .info-input:focus {
            outline: none; border-color: var(--input-focus-border-color);
            box-shadow: 0 0 0 2px var(--input-focus-shadow);
        }
        .calendar-widget .goals-list {
            list-style: disc; padding-left: 2rem; margin: 0.5rem 0 0 0;
            font-size: 1.2rem;
            color: var(--card-muted-text-color);
        }
        .calendar-widget .goals-list li { margin-bottom: 0.3rem; }
    
        /* General Modal Styles from progress.html - will be augmented */
        .modal {
            display: none;
            position: fixed; z-index: 1050; /* Increased z-index from membership for consistency */
            left: 0; top: 0; width: 100%; height: 100%;
            overflow: auto; background-color: var(--modal-overlay-bg);
            align-items: center; justify-content: center;
            opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0s linear 0.3s;
        }
        .modal.show, .modal.active { /* .active from membership.html, .show from progress.html */
            display: flex;
            opacity: 1; visibility: visible; transition: opacity 0.3s ease;
        }
        .modal-content { /* Base for all modals */
            background-color: var(--modal-bg); /* Uses progress.html var */
            color: var(--modal-text-color); /* Uses progress.html var */
            margin: auto;
            padding: 2rem 2.5rem; /* Default padding from progress */
            border: 1px solid var(--card-border-color); /* Uses progress.html var */
            border-radius: 8px;
            width: 90%;
            max-width: 450px; /* Default max-width from progress */
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            position: relative;
            font-size: 1.4rem; /* Default font size */
            animation: fadeInModal 0.3s ease-out forwards; /* From membership.html */
        }
        @keyframes fadeInModal { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }

        /* Close button styling, unified */
        .modal-content .close-button, .modal-content .modal-close-btn {
            color: var(--color-text-muted); /* Consistent muted color */
            position: absolute; top: 10px; right: 15px; /* Unified position */
            font-size: 2.8rem; /* Unified size from membership */
            font-weight: bold; cursor: pointer; line-height: 1;
            background: none; border: none; /* Ensure no default button styles */
        }
        .modal-content .close-button:hover, .modal-content .modal-close-btn:hover {
            color: var(--text-color); /* Darker text on hover for dark modals */
        }
        
        /* LogoutConfirmationModal specific styling (light background) */
        #logoutConfirmationModal .modal-content {
            background-color: #fefefe;
            color: var(--color-black);
            border-color: #888;
        }
         #logoutConfirmationModal #logoutModalMessage { color: var(--color-black); }
         #logoutConfirmationModal .close-button:hover, 
         #logoutConfirmationModal .modal-close-btn:hover { color: black; } /* Black on hover for light modal */
         #logoutConfirmationModal #cancelLogoutButton { /* Specific cancel button for light modal */
            background-color: #aaa; color: #fff; border: 1px solid #999;
        }
        #logoutConfirmationModal #cancelLogoutButton:hover {
            background-color: #888;
        }
        /* Primary button for logout (light modal) - uses progress.html vars */
        #logoutConfirmationModal #okLogoutButton {
            background-color: var(--button-primary-bg); color: var(--button-primary-text);
            border: 1px solid var(--main-color);
        }
        #logoutConfirmationModal #okLogoutButton:hover {
            background-color: var(--button-primary-hover-bg); /* progress.html hover */
            color: var(--main-color); /* progress.html hover */
            border-color: var(--color-gold-light); /* progress.html hover */
        }

        /* General modal message styling */
        .modal-content p, 
        .modal-content #logoutModalMessage, /* Already styled for logout */
        .modal-content #stopModalMessage, 
        .modal-content #refundModalMessage, 
        .modal-content #confirmSwitchGymActionModalMessage, 
        .modal-content #switchGymSuccessModalMessage,
        .modal-content #refundRequestSubmittedModalMessage {
            font-size: 1.6rem; /* from membership.html for consistency */
            margin-top: 1rem; margin-bottom: 2rem; line-height: 1.6; text-align: center;
            font-weight: 500; /* from membership.html */
            color: var(--modal-text-color); /* progress.html default text color for modals */
        }
        #confirmSwitchGymActionModalMessage strong {
            color: var(--main-color); display: block; margin-top: 0.5rem;
        }


        /* Modal Actions styling from progress.html (base) */
         .modal-content .modal-actions {
            text-align: center; margin-top: 1.5rem;
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }
        /* General modal button styling from progress.html (base) */
         .modal-content .modal-actions button,
         .modal-content #cancelLogoutButton, /* Already styled */
         .modal-content #okLogoutButton,    /* Already styled */
         .modal-content #alertModalOkButton { /* If an alert modal is added */
            font-weight: 600; font-size: 1.4rem; margin: 0;
            min-width: 100px;
            padding: 0.9rem 1.8rem; border-radius: 6px; cursor: pointer;
            transition: all 0.3s ease;
        }

        /* Styles for newly added modals from membership.html */
        /* Generic primary button for dark modals - using progress.html vars */
        .modal-content .btn-primary {
            background-color: var(--button-primary-bg); color: var(--button-primary-text);
            border: 1px solid var(--main-color);
        }
        .modal-content .btn-primary:hover {
            background-color: var(--button-primary-hover-bg); /* progress.html hover */
            color: var(--main-color); /* progress.html hover */
            border-color: var(--color-gold-light); /* progress.html hover */
            box-shadow: 0 0 1rem rgba(255, 215, 0, 0.3); /* Adding subtle glow on hover for primary */
        }
        /* Generic secondary/cancel button for dark modals */
        .modal-content .btn-dark-cancel {
            background-color: var(--button-secondary-bg); 
            color: var(--button-secondary-text); 
            border: 1px solid #444; /* Slightly darker border for secondary */
        }
        .modal-content .btn-dark-cancel:hover {
            background-color: var(--button-secondary-hover-bg); 
            border-color: #555;
        }

        .modal-actions-centered { /* from membership.html */
            margin-top: 1.5rem; display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap;
        }
        .modal-content .modal-actions-centered .btn,
        #viewMembershipModal .status-actions .btn { /* For buttons in view membership modal */
            padding: 1rem 2.5rem; /* from membership.html */
            font-size: 1.5rem; /* from membership.html */
            flex: 1; min-width: 120px; margin: 0 5px;
            border-radius: 8px; /* from membership.html */
        }
        #viewMembershipModal .status-actions .btn.btn-primary:hover {
             box-shadow: 0 0 1.6rem var(--main-color); /* specific hover from membership.html */
             background-color: transparent; /* specific hover from membership.html */
             color: var(--main-color); /* Ensure text color changes */
        }
         #viewMembershipModal .status-actions .btn.btn-secondary { /* Special secondary for view membership */
            background-color: transparent;
            color: var(--main-color);
            border-color: var(--main-color);
        }
        #viewMembershipModal .status-actions .btn.btn-secondary:hover {
            background-color: var(--main-color);
            color: var(--color-black);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.2);
        }


        /* ViewMembershipModal specific styles */
        #viewMembershipModal .modal-content { max-width: 550px; text-align: center; }
        #viewMembershipModal h2 {
            font-size: 2.4rem; color: var(--main-color); margin-bottom: 1.5rem;
            text-align: center; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border-color-light);
        }
        #viewMembershipModal .status-details { margin-bottom: 2rem; text-align: center; }
        #viewMembershipModal .status-text {
            font-size: 1.7rem; margin-bottom: 0.8rem; color: var(--color-text-muted);
        }
        #viewMembershipModal .status-text .current-status,
        #viewMembershipModal .status-text .expiry-date {
            color: var(--text-color); font-weight: 600;
        }
        #viewMembershipModal .status-text .current-status { color: var(--color-gold-light); }
        #viewMembershipModal .status-note {
            font-size: 1.3rem; color: var(--color-text-muted); font-style: italic; margin-top: 1rem;
        }
        #viewMembershipModal .status-actions { /* Flex container for buttons */
            display: flex; justify-content: center; gap: 1.5rem; flex-wrap: wrap; margin-top: 2rem;
        }
        /* #viewMembershipModal .status-actions .btn already styled by .modal-actions-centered .btn */


        /* StopMembershipModal specific styles */
        #stopMembershipModal .modal-content { max-width: 450px; }
        #stopMembershipModal h3 { color: #d32f2f; font-size: 2rem; margin-bottom: 1.5rem; text-align:center; }
        #confirmStopMembershipBtn.btn-danger { /* Specific danger button */
            background-color: #d32f2f; border-color: #d32f2f; color: white;
        }
        #confirmStopMembershipBtn.btn-danger:hover {
            background-color: #b71c1c; border-color: #b71c1c; color: white;
            box-shadow: 0 0 1rem rgba(183, 28, 28, 0.5);
        }

        /* Switch Gym & Request Refund Modals (Forms) */
        #switchGymModal .modal-content, #requestRefundModal .modal-content {
            max-width: 480px; text-align: left; 
        }
        #switchGymModal h3, #requestRefundModal h3, #confirmSwitchGymActionModal h3, 
        #switchGymSuccessModal h3, #refundRequestSubmittedModal h3 {
            text-align: center; font-size: 2rem; color: var(--main-color); margin-bottom: 2rem;
        }
        #switchGymModal .form-group, #requestRefundModal .form-group { margin-bottom: 1.5rem; }
        .error-message {
            display: block; color: var(--error-color); font-size: 1.3rem; margin-top: 0.5rem; text-align: left; 
        }
        #switchGymModal label, #requestRefundModal label {
            display: block; font-size: 1.5rem; color: var(--color-text-muted);
            margin-bottom: 0.8rem; font-weight: 500;
        }
        #switchGymModal select {
            width: 100%; padding: 1.2rem 1.5rem; font-size: 1.5rem;
            border-radius: 6px; border: 1px solid var(--input-border-color); /* progress.html var */
            background-color: var(--input-bg); /* progress.html var */
            color: var(--input-text-color); /* progress.html var */
            outline: none; appearance: none; -webkit-appearance: none; -moz-appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23aaaaaa' class='bi bi-caret-down-fill' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
            background-repeat: no-repeat; background-position: right 1.5rem center; background-size: 1em;
            cursor: pointer;
        }
        #switchGymModal select:focus {
            border-color: var(--input-focus-border-color); /* progress.html var */
            box-shadow: 0 0 0 2px var(--input-focus-shadow); /* progress.html var */
        }
        #switchGymModal select option {
            background-color: var(--input-bg); /* progress.html var */
            color: var(--input-text-color); /* progress.html var */
        }
        #switchGymModal .modal-actions { /* This is for the form modal */
            margin-top: 2rem; display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap;
        }
         #switchGymModal .modal-actions .btn { flex: 1; } /* Make buttons take equal space */


        #requestRefundModal textarea {
            width: 100%; padding: 1rem 1.2rem; font-size: 1.5rem;
            border-radius: 6px; border: 1px solid var(--input-border-color); /* progress.html var */
            background-color: var(--input-bg); /* progress.html var */
            color: var(--input-text-color); /* progress.html var */
            outline: none; min-height: 100px; resize: vertical;
        }
        #requestRefundModal textarea:focus {
            border-color: var(--input-focus-border-color); /* progress.html var */
            box-shadow: 0 0 0 2px var(--input-focus-shadow); /* progress.html var */
        }


        /* MAIN CONTENT Tabs from progress.html */
        .main-tab-content {
            border: 2px solid var(--card-accent-color);
            background-color: var(--card-bg); color: var(--card-text-color);
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    
        .content-placeholder {
            padding: 1.5rem; background-color: transparent;
            border-radius: 0; border: none; min-height: 300px; box-shadow: none;
        }
        .content-placeholder > h1 {
            font-size: 1.8rem; margin-bottom: 1.5rem; font-weight: 600;
            color: var(--card-text-color); text-align: left; padding-bottom: 0.8rem;
            border-bottom: 2px solid var(--main-color); display: inline-block;
        }
        .content-placeholder > h1::before { content: " "; }
    
        .main-content-tabs {
            display: flex; justify-content: center; flex-wrap: wrap; margin-bottom: 2rem;
            padding: 1rem 1.5rem; border-bottom: 2px solid var(--card-border-color); gap: 1rem;
        }
        button.main-tab-button {
            display: inline-flex; align-items: center; gap: 0.7rem;
            padding: 0.8rem 1.5rem; font-size: 1.5rem; font-weight: 500;
            color: var(--tab-inactive-text); background-color: var(--tab-inactive-bg);
            border: 1px solid #444; border-radius: 6px; cursor: pointer; transition: all 0.3s ease; font-family: inherit;
        }
        button.main-tab-button i { font-size: 1.8rem; line-height: 1; }
        button.main-tab-button:hover { background-color: var(--tab-hover-bg); border-color: #555; color: var(--tab-hover-text); }
        button.main-tab-button.active {
            background-color: var(--main-color); color: var(--color-black); font-weight: 600;
            border-color: var(--color-gold-light); box-shadow: 0 2px 5px rgba(218, 165, 32, 0.2);
        }
    
        #tabs-1 .workout-type-block { border-bottom: none; padding-bottom: 0; margin-bottom: 1rem;}
        #tabs-1 .workout-type {
            font-size: 1.4rem; font-weight: 500; color: var(--card-text-color);
            background-color: var(--input-bg); padding: 1rem 1.5rem; border-radius: 4px;
            border: 1px solid var(--card-border-color);
        }
        .workout-table-container { overflow-x: auto; margin-top: 1.5rem; }
        .workout-table { width: 100%; border-collapse: collapse; font-size: 1.2rem; }
        .workout-table th, .workout-table td {
            padding: 1.2rem 1.5rem; text-align: left; border: 1px solid var(--table-border-color);
            color: var(--card-text-color);
        }
        .workout-table th {
            background-color: var(--table-header-bg); font-weight: 600;
            color: var(--card-accent-color); text-transform: uppercase; font-size: 1.1rem;
        }
        .workout-table th.date-col, .workout-table td.date-col {
            width: 130px; white-space: nowrap;
        }
        .workout-table tbody tr:nth-child(even) { background-color: var(--table-row-even-bg); }
        .workout-table tbody tr:hover { background-color: var(--table-row-hover-bg); }
        .workout-table .notes-cell { font-style: italic; color: var(--card-muted-text-color); font-size: 0.9em; }
    
        .daily-log-section, .coach-feedback-section, .meal-logging-section {
            margin-top: 2.5rem; padding: 1.5rem; background-color: var(--snd-bf-color);
            border: 1px solid var(--card-border-color); border-radius: 6px;
        }
        .daily-log-section h3, .coach-feedback-section h3, .meal-logging-section h3 {
            font-size: 1.6rem; color: var(--card-accent-color); margin-bottom: 1.2rem;
            padding-bottom: 0.6rem; border-bottom: 1px solid var(--card-border-color); font-weight: 600;
        }
        .daily-log-section h4, .meal-logging-section h4 {
            font-size: 1.5rem; color: var(--card-text-color); font-weight: 500;
            margin-bottom: 1rem; margin-top: 1.5rem;
        }
        .meal-logging-section h4 i {
            margin-right: 0.8rem; font-size: 1.6rem;
            color: var(--card-accent-color);
        }
    
        .exercise-log-entry-fields {
            border: 1px solid var(--card-border-color); padding: 1.2rem; border-radius: 4px;
            margin-bottom: 1.5rem; background-color: var(--color-dark-gray);
        }
        .exercise-log-entry-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.2rem; margin-bottom: 1.5rem;
        }
        .exercise-log-form-group { display: flex; flex-direction: column; }
        .exercise-log-form-group.full-width { grid-column: 1 / -1; }
        .exercise-log-form-group label {
            font-size: 1.4rem; font-weight: 500; color: var(--card-muted-text-color); margin-bottom: 0.6rem;
        }
        .log-input-field, .general-summary-area textarea, .coach-comment-input-area textarea {
            width: 100%; padding: 1rem 1.2rem; font-size: 1.3rem;
            font-family: var(--font-primary);
            background-color: var(--input-bg); border: 1px solid var(--input-border-color);
            color: var(--input-text-color); border-radius: 4px;
        }
        .log-input-field::placeholder, .general-summary-area textarea::placeholder, .coach-comment-input-area textarea::placeholder {
            color: var(--card-muted-text-color); font-size: 1.2rem;
        }
        .log-input-field:focus, .general-summary-area textarea:focus, .coach-comment-input-area textarea:focus {
            outline: none; border-color: var(--input-focus-border-color); box-shadow: 0 0 0 2px var(--input-focus-shadow);
        }
        .exercise-log-form-group textarea.log-input-field, .general-summary-area textarea, .coach-comment-input-area textarea {
            min-height: 80px; resize: vertical; line-height: 1.5;
        }
    
        #addExerciseToLogBtn {
            margin-bottom: 1.5rem; background-color: var(--button-secondary-bg);
            color: var(--button-secondary-text); border: 1px solid #444;
        }
        #addExerciseToLogBtn:hover { background-color: var(--button-secondary-hover-bg); border-color: #555; }
    
        .general-summary-area { margin-bottom: 1.5rem; margin-top: 1.5rem; }
        .general-summary-area label {
            display: block; font-size: 1.4rem; font-weight: 500;
            color: var(--card-text-color); margin-bottom: 0.8rem;
        }
    
        .meal-log-group {
            padding: 1.5rem 0;
            border-bottom: 1px dashed var(--card-border-color);
        }
        .meal-log-group:last-of-type { border-bottom: none; }
        .food-item-entry-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            align-items: end;
            margin-bottom: 1rem;
        }
         .food-item-entry-form label {
            display: block;
            font-size: 1.3rem;
            font-weight: 500;
            color: var(--card-muted-text-color);
            margin-bottom: 0.5rem;
        }
        .food-item-entry-form .log-input-field {
            font-size: 1.25rem; padding: 0.8rem 1rem;
        }
        .food-item-entry-form .log-input-field::placeholder { font-size: 1.15rem; }
    
        .add-food-item-btn {
            padding: 0.9rem 1.5rem;
            font-size: 1.3rem;
            grid-column: 1 / -1;
             margin-top: 1rem;
        }
    
        .logged-food-list {
            list-style: none; padding-left: 0; margin-top: 1rem;
        }
        .logged-food-list li {
            font-size: 1.3rem;
            color: var(--card-muted-text-color);
            padding: 0.8rem 1rem; background-color: var(--input-bg);
            border-radius: 3px; margin-bottom: 0.8rem; border-left: 3px solid var(--main-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logged-food-list li .remove-food-item {
            color: var(--stat-card-sub-decrease);
            cursor: pointer;
            font-size: 1.6rem;
            margin-left: 1rem;
        }
        .logged-food-list li .remove-food-item:hover { color: red; }
        #updateNutritionSummaryBtn { margin-top: 1.5rem; }
    
        .action-button {
            padding: 0.9rem 1.8rem; font-size: 1.4rem; font-weight: 500;
            color: var(--button-primary-text); background-color: var(--button-primary-bg);
            border: 1px solid var(--main-color); border-radius: 6px; cursor: pointer;
            transition: all 0.3s ease; display: inline-flex; align-items: center; gap: 0.8rem;
        }
        .action-button:hover {
            background-color: var(--button-primary-hover-bg);
            color: var(--main-color);
            border-color: var(--color-gold-light);
            transform: translateY(-1px);
        }
        .action-button i { font-size: 1.6rem; }
    
        .coach-feedback-section { margin-bottom: 0; }
        .coach-comment-input-area { margin-bottom: 1.5rem;}
        .coach-comment-input-area label {
            display: block; font-size: 1.4rem; font-weight: 500;
            color: var(--card-text-color); margin-bottom: 0.8rem;
        }
        .coach-comments-display { margin-bottom: 1.5rem; }
        .coach-comment-item {
            background-color: var(--color-dark-gray); padding: 1.2rem 1.5rem; border-radius: 4px;
            margin-bottom: 1.2rem; border-left: 4px solid var(--main-color);
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        .coach-comment-item p {
            font-size: 1.3rem;
            color: var(--card-text-color);
            margin: 0 0 0.5rem 0; line-height: 1.6;
        }
        .coach-comment-item .comment-meta {
            font-size: 1.1rem;
            color: var(--card-muted-text-color); font-style: italic;
        }
        .coach-comment-item .comment-meta .coach-name {
            font-weight: 600; color: var(--card-accent-color);
        }
        .no-comments {
            font-size: 1.3rem; color: var(--card-muted-text-color); padding: 1rem; text-align: center;
            border: 1px dashed var(--card-border-color); border-radius: 4px;
        }
    
        .card-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: var(--grid-gap); margin-bottom: 2rem; }
        .stat-card {
            text-align: center; padding: 1.5rem 1rem; background-color: var(--snd-bf-color);
        }
        .stat-card .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; border-bottom: 1px solid var(--card-border-color); padding-bottom: 0.8rem;}
        .stat-card .card-header h3 { margin: 0; font-size: 1.4rem; color: var(--card-text-color); font-weight: 600;}
        .stat-card .card-header i { font-size: 2rem; color: var(--stat-card-icon-color); }
        .stat-card .card-body .value { font-size: 2.2rem; font-weight: 600; color: var(--stat-card-value-color); margin: 0 0 0.5rem 0; line-height: 1.2; }
        .stat-card .card-body .unit { font-size: 1.1rem; font-weight: 400; color: var(--card-muted-text-color); margin-left: 0.3rem; }
        .stat-card .card-body .sub-value { margin: 0 0 1rem 0; font-size: 1.2rem; font-weight: 500; }
        .stat-card .card-body .sub-value.increase { color: var(--stat-card-sub-increase); }
        .stat-card .card-body .sub-value.decrease { color: var(--stat-card-sub-decrease); }
        .stat-card .card-body .description { font-size: 1.2rem; color: var(--card-muted-text-color); margin: 0; }
    
        .graph-controls {
            display: flex; flex-wrap: wrap; gap: 1.5rem; align-items: center;
            background-color: var(--input-bg); padding: 1rem; border-radius: 5px;
            border: 1px solid var(--card-border-color); margin-bottom: 2rem;
        }
        .control-group { display: flex; align-items: center; gap: 0.8rem; }
        .control-group label { font-weight: 500; color: var(--card-text-color); font-size: 1.3rem; }
        .control-group i { font-size: 1.6rem; color: var(--card-accent-color); }
        .control-group select {
            padding: 0.8rem 1.2rem; border: 1px solid var(--input-border-color); border-radius: 4px;
            background-color: var(--snd-bf-color); color: var(--input-text-color);
            font-size: 1.2rem; cursor: pointer;
        }
        .control-group select:focus {
            outline: none; border-color: var(--input-focus-border-color); box-shadow: 0 0 0 2px var(--input-focus-shadow);
        }
        .graph-placeholder {
            background-color: var(--snd-bf-color); padding: 1.5rem; border-radius: 5px;
            border: 1px solid var(--card-border-color);
        }
        .chart-area h3 { text-align: center; margin-bottom: 1.5rem; font-size: 1.5rem; color: var(--chart-title-color); font-weight: 600;}
        .canvas-wrapper { position: relative; height: 300px; width: 100%; }
    
        .tabs { display: flex; justify-content: center; flex-wrap: wrap; margin-bottom: 1.5rem; border-bottom: 1px solid var(--card-border-color); padding-bottom: 0.5rem; gap: 1rem; }
        .tabs .tab-button {
            color: var(--tab-inactive-text); font-size: 1.3rem; padding: 0.8rem 1.2rem; border-radius: 4px;
            transition: color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease; white-space: nowrap;
            border: 2px solid transparent; background-color: transparent; cursor: pointer; font-weight: 500;
        }
        .tabs .tab-button:hover { color: var(--tab-hover-text); background-color: var(--tab-hover-bg); }
        .tabs .tab-button.active {
            background-color: var(--main-color); color: var(--color-black); font-weight: 600;
            border-color: var(--color-gold-light);
        }
        .nutrition-tab-content { display: none; padding-top: 1rem; animation: fadeIn 0.5s ease-in-out; }
        .nutrition-tab-content.active { display: block; }
        .nutrition-tab-content h2 {
            font-size: 1.5rem; margin-bottom: 1.5rem; font-weight: 600;
            color: var(--card-muted-text-color); text-align: center;
        }
        .nutrition-details-full { max-width: 700px; margin: 0 auto; }
        .chart-placeholder-container { max-width: 300px; margin: 0 auto 1.5rem auto; position: relative;}
    
        .calories-breakdown { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-bottom: 1.5rem; max-width: 700px; margin-left: auto; margin-right: auto; }
        .meal-item {
            display: flex; align-items: center; gap: 1rem; padding: 1rem 1.2rem;
            background-color: var(--snd-bf-color); border-radius: 4px;
            border: 1px solid var(--card-border-color);
        }
        .meal-info { font-size: 1.2rem; flex-grow: 1; }
        .meal-info div:first-child { font-weight: 500; color: var(--card-text-color); }
        .meal-info div:last-child { color: var(--card-muted-text-color); font-size: 0.9em; }
    
        .calorie-summary {
            display: flex; flex-direction: column; gap: 1rem; color: var(--card-muted-text-color);
            font-size: 1.3rem; margin-top: 1rem; padding-top: 1rem;
            border-top: 1px solid var(--card-border-color); max-width: 400px; margin-left: auto; margin-right: auto;
        }
        .summary-item { display: flex; justify-content: space-between; align-items: center; }
        .summary-item span:last-child { font-weight: 600; color: var(--card-text-color); }
        .summary-item span.exercise { color: #f44336; }
        .summary-item.goal span:last-child { color: var(--card-accent-color); font-size: 1.1em; font-weight: bold; }
        .summary-divider { border: none; height: 1px; background-color: var(--card-border-color); margin: 0.5rem 0; }
    
        .nutrient-header { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 1rem; padding: 0 1rem 1rem 1rem; font-size: 1.1rem; font-weight: 600; text-align: right; border-bottom: 1px solid var(--card-border-color); margin-bottom: 1rem; text-transform: uppercase; color: var(--card-accent-color); }
        .nutrient-header span:first-child { text-align: left; }
    
        .nutrient-list { list-style: none; max-height: 400px; overflow-y: auto; padding-right: 0.5rem; margin:0; }
        .nutrient-list li { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 1rem; padding: 1rem; border-bottom: 1px solid #282828; align-items: center; font-size: 1.3rem; }
        .nutrient-list li:last-child { border-bottom: none; }
        .nutrient-list li span:first-child { font-weight: 500; text-align: left; color: var(--card-text-color); }
        .nutrient-list li span:not(:first-child) { text-align: right; color: var(--card-muted-text-color); }
    
        .macros-legend { display: flex; flex-direction: column; gap: 1rem; max-width: 500px; margin: 1.5rem auto 0 auto; }
        .legend-item {
            display: grid; grid-template-columns: auto 1fr auto auto; align-items: center; gap: 1rem;
            font-size: 1.3rem; color: var(--card-text-color); padding: 1rem;
            background-color: var(--snd-bf-color); border-radius: 4px; border: 1px solid var(--card-border-color);
        }
        .color-square { width: 14px; height: 14px; display: inline-block; border-radius: 3px; border: 1px solid rgba(255,255,255,0.1); }
        .legend-item .percentage { font-weight: 500; text-align: right; }
        .legend-item .goal-percentage { color: var(--card-muted-text-color); text-align: right; font-style: italic; font-size: 0.9em; }
    
        .subscribe-section { background-color: var(--snd-bf-color); padding: 4rem 0; border-top: 1px solid var(--border-color-light); }
        .subscribe-content { max-width: 1200px; margin: 0 auto; padding: 0 2rem; display: grid; grid-template-columns: 1fr 1.5fr; gap: 3rem; align-items: start; }
        .subscribe-text h2 { font-size: 2.4rem; color: var(--main-color); margin-bottom: 1rem; text-align: left; }
        .subscribe-text p { font-size: 1.5rem; color: var(--color-text-muted); margin-bottom: 2rem; line-height: 1.7; }
        .subscribe-form { display: flex; gap: 1rem; margin-bottom: 2rem; }
        .subscribe-form input[type="email"] { flex-grow: 1; padding: 1.2rem 1.5rem; font-size: 1.5rem; border-radius: 6px; border: 1px solid var(--border-color-light); background-color: var(--color-dark-gray); color: var(--text-color); outline: none; }
        .subscribe-form input[type="email"]::placeholder { color: var(--color-text-muted); }
        .subscribe-form input[type="email"]:focus { border-color: var(--main-color); box-shadow: 0 0 0 2px rgba(255, 215, 0, 0.2); }
        .subscribe-form button.btn-primary, .subscribe-form button.btn.btn-primary {
            padding: 1.2rem 2.5rem; font-size: 1.5rem; min-width: auto; border-radius: 6px;
            color: var(--button-primary-text); background-color: var(--button-primary-bg); border: 1px solid var(--main-color);
        }
         .subscribe-form button.btn-primary:hover, .subscribe-form button.btn.btn-primary:hover {
            background-color: var(--button-primary-hover-bg); color: var(--main-color); border-color: var(--color-gold-light);
        }
    
        .social-icons { display: flex; gap: 1.5rem; }
        .social-icons a { color: var(--color-text-muted); font-size: 2.2rem; transition: color 0.3s ease, transform 0.3s ease; }
        .social-icons a:hover { color: var(--main-color); transform: translateY(-3px); }
        .footer-links { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 2rem; }
        .footer-links h4 { font-size: 1.6rem; color: var(--main-color); margin-bottom: 1rem; font-weight: 600; }
        .footer-links ul { list-style: none; padding: 0; margin: 0; }
        .footer-links li { margin-bottom: 0.8rem; }
        .footer-links a { font-size: 1.4rem; color: var(--color-text-muted); transition: color 0.3s ease; }
        .footer-links a:hover { color: var(--text-color); text-decoration: underline; }
    
        footer { background-color: var(--bg-color); color: var(--color-text-muted); text-align: center; padding: 2rem 0; font-size: 1.3rem; border-top: 1px solid var(--border-color-light); margin-top: auto; }
        footer .container { max-width: 1200px; margin: 0 auto; padding: 0 2rem; }
    
    
        @media (max-width: 1024px) {
            header {
                padding: 1rem 5%;
            }
            .navbar-right img.profile-pic {
                width: 45px; 
                height: 45px; 
                 margin-left: 0; 
                 margin-right: 0;
            }
            .navbar-right { gap: 1.5rem; }
            .welcome-text { font-size: 1.5rem; }
        }
    
        @media (max-width: 991px) { 
             main.content-grid {
                grid-template-columns: 1fr;
                padding-top: calc(var(--header-height-mobile) + 1.5rem);
                padding-left: 1rem;
                padding-right: 1rem;
             }
             .calendar-widget { order: -1; margin-bottom: var(--grid-gap); }
    
            header {
                height: var(--header-height-mobile);
                padding: 1rem 5%; 
            }
            .logo img { max-width: 100px; } 
            #menu-icon {
                display: block;
            }

            .navbar {
                position: absolute; 
                top: 100%; 
                right: -100%; 
                width: 250px; 
                background: var(--color-black); 
                flex-direction: column; 
                align-items: center; 
                padding: 2rem; 
                transition: right .50s ease; 
                box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
                border-radius: 0 0 10px 10px; 
                justify-content: flex-start; 
                flex-grow: 0; 
                margin-left: 0;
                height: auto; 
                overflow-y: visible; 
                border-top: none; 
            }
            .navbar.active { 
                right: 5%; 
                display: flex; 
            }

            .navbar-left, .navbar-right { 
                flex-direction: column; 
                width: 100%; 
                align-items: center; 
                gap: 0; 
            }
            .navbar-right { 
                margin-top: 1.5rem; 
                gap: 1.5rem; 
            }
            .navbar li { 
                width: 100%; 
                text-align: center; 
                margin-bottom: 1.5rem; 
            }
            .navbar-right li { margin-bottom: 0; } 

            .navbar a { 
                display: block; 
                margin: 0 !important; 
                padding: 1rem 0; 
                font-size: 2rem; 
                text-align: center; 
                border-bottom: none; 
            }
            .navbar a:hover, .navbar a.active { 
                color: var(--main-color); 
                border-bottom: none; 
            }
        
            .navbar .profile-pic { 
                margin: 0 auto 1rem auto; 
            }
            .profile-menu-container { 
                position: static; 
                width: 100%; 
                margin-bottom: 1rem; 
            }
            .profile-dropdown {
                position: static; 
                display: block; 
                width: 100%; 
                margin-top: 0.5rem; 
                margin-bottom: 0;
                box-shadow: none; 
                border: none; 
                border-top: 1px solid var(--border-color-light);
                border-bottom: 1px solid var(--border-color-light); 
                border-radius: 0;
                background-color: transparent; 
                padding: 0; 
                animation: none;
            }
            .profile-dropdown li a.dropdown-item {
                text-align: center; 
                padding: 1rem 1.5rem; 
                font-size: 1.6rem; 
                border-bottom: 1px solid var(--border-color-light);
            }
            .profile-dropdown li:last-child a.dropdown-item { border-bottom: none; }
            .profile-dropdown li a.dropdown-item:hover { background-color: var(--color-dark-gray); } 
        
            .welcome-text {
                margin-bottom: 1rem; 
                text-align: center; 
                font-size: 1.6rem; 
                width: auto; 
                padding: 0; 
                border-bottom: none; 
            }
            .navbar-right li a#logout-link {
                margin-top: 0.5rem;
                width: auto; 
                padding: 1rem 0; 
                justify-content: center; 
            }
    
             .workout-table th, .workout-table td { padding: 1rem 0.8rem; font-size: 1.1rem;}
             .workout-table .notes-cell { font-size: 0.9em; }
             .workout-table th.date-col, .workout-table td.date-col { width: auto; }
             .subscribe-content { grid-template-columns: 1fr; gap: 2rem; }
             .subscribe-text{ text-align: center; }
             .subscribe-form { justify-content: center; }
             .social-icons { justify-content: center; }
             .footer-links { grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); text-align: center;}
        }
    
         @media (max-width: 767px) {
             header { 
                 padding: 1rem 4%; 
                 height: calc(var(--header-height-mobile) - 10px); 
             } 
             main.content-grid {
                 padding-top: calc(var(--header-height-mobile) - 10px + 1rem); 
                 gap: 1rem;
             }
             .content-placeholder { padding: 1rem; }
             .content-placeholder > h1 { font-size: 1.7rem; }
             .main-tab-button { font-size: 1.3rem; padding: 0.7rem 1.2rem; }
             .main-content-tabs { padding: 1rem; gap: 0.8rem; }
    
             .workout-table thead { display: none; }
             .workout-table, .workout-table tbody, .workout-table tr, .workout-table td { display: block; width: 100%; }
             .workout-table tr { margin-bottom: 1.5rem; border: 1px solid var(--table-border-color); border-radius: 4px; background-color: var(--card-bg); overflow: hidden; }
             .workout-table td { text-align: right; padding-left: 50%; position: relative; border: none; border-bottom: 1px dotted var(--card-border-color); padding-top: 0.8rem; padding-bottom: 0.8rem; }
             .workout-table td:last-child { border-bottom: none; }
             .workout-table td::before { content: attr(data-label); position: absolute; left: 1rem; width: 45%; padding-right: 1rem; white-space: nowrap; text-align: left; font-weight: bold; color: var(--card-accent-color); text-transform: uppercase; font-size: 0.9em; }
             .workout-table td.date-col::before { content: attr(data-label); }
    
             .card-container { grid-template-columns: 1fr; gap: 1rem; }
             .stat-card { padding: 1.2rem 0.8rem; }
             .stat-card .card-header h3 { font-size: 1.3rem; } 
             .stat-card .card-body .value { font-size: 2rem; } 
             .stat-card .card-body .unit, .stat-card .card-body .description { font-size: 1.1rem; }
    
             .graph-controls {
                flex-direction: column; align-items: stretch; gap: 1rem; padding: 0.8rem;
            }
            .control-group { justify-content: space-between; }
            .control-group label, .control-group select { font-size: 1.2rem; }
            .control-group select { flex-grow: 1; min-width: 150px; }
    
             .calories-breakdown { grid-template-columns: 1fr; }
             .nutrient-list li, .nutrient-header { font-size: 1.2rem; grid-template-columns: 1.5fr 1fr 1fr 1fr; padding: 0.8rem; }
             .nutrient-header { padding: 0 0.8rem 0.8rem 0.8rem; }
             .legend-item { grid-template-columns: auto 1fr auto auto; font-size: 1.2rem; padding: 0.8rem; }
    
             .exercise-log-entry-grid { grid-template-columns: 1fr; gap: 1rem; }
             .food-item-entry-form { grid-template-columns: 1fr; gap: 0.8rem; }
             .food-item-entry-form .log-input-field { margin-bottom: 0.5rem; }
             .food-item-entry-form .add-food-item-btn { grid-column: 1 / -1; width: 100%; margin-top: 0.5rem; padding: 0.8rem 1.2rem; font-size: 1.2rem; }
             .add-food-item-btn i { font-size: 1.4rem; }
    
             .subscribe-form { flex-direction: column; align-items: stretch; }
             .subscribe-form button.btn-primary, .subscribe-form button.btn.btn-primary { width: 100%; }
             .subscribe-text h2 { font-size: 2rem; }
             .subscribe-text p { font-size: 1.4rem; }
    
             .footer-links { text-align: center;}
             /* Modal content adjustments for smaller screens */
             .modal-content { padding: 1.5rem; max-width: 95%; }
             .modal-content p, .modal-content #logoutModalMessage, 
             .modal-content #stopModalMessage, .modal-content #refundModalMessage,
             .modal-content #confirmSwitchGymActionModalMessage, 
             .modal-content #switchGymSuccessModalMessage,
             .modal-content #refundRequestSubmittedModalMessage { font-size: 1.4rem; }

             #viewMembershipModal .modal-content { width: 90%; max-width: 95%; } /* Ensure it fits */
             #viewMembershipModal .status-actions { flex-direction: column; align-items: stretch; gap: 1rem; }
             #viewMembershipModal .status-actions .btn { width: 100%; min-width: unset; }

             .modal-actions-centered .btn { width: 100%; } /* Make buttons full width in small modals */
        }
    
         @media (max-width: 480px) {
              main.content-grid {
                padding-top: calc(var(--header-height-mobile) - 20px + 1rem); 
                padding-left: 0.8rem;
                padding-right: 0.8rem;
              }
              header { 
                  padding: 0.8rem 3%; 
                  height: calc(var(--header-height-mobile) - 20px); 
              }
              #menu-icon { font-size: 3.2rem; } 
              .logo img { max-width: 70px; }
    
              .main-tab-button { font-size: 1.2rem; padding: 0.6rem 1rem; gap: 0.5rem; }
              .main-tab-button i { font-size: 1.6rem; }
              .content-placeholder > h1 { font-size: 1.6rem; }
    
              .workout-table td { padding-left: 40%; font-size: 1rem; }
              .workout-table td::before { width: 35%; font-size: 0.85em; }
    
              .daily-log-section h3, .coach-feedback-section h3, .meal-logging-section h3 { font-size: 1.5rem; }
              .daily-log-section h4, .meal-logging-section h4 { font-size: 1.4rem; }
              .exercise-log-form-group label { font-size: 1.3rem; }
              .log-input-field, .general-summary-area textarea, .coach-comment-input-area textarea { font-size: 1.25rem; padding: 0.8rem 1rem; }
              .log-input-field::placeholder { font-size: 1.15rem; }
              .food-item-entry-form label { font-size: 1.25rem; }
              .food-item-entry-form .log-input-field { font-size: 1.2rem; }
              .general-summary-area label, .coach-comment-input-area label { font-size: 1.3rem; }
              .action-button { font-size: 1.3rem; padding: 0.8rem 1.5rem; }
              .action-button i { font-size: 1.5rem; }
    
              .coach-comment-item { padding: 1rem; }
              .coach-comment-item p { font-size: 1.2rem; }
              .coach-comment-item .comment-meta { font-size: 1.0rem; }
              .logged-food-list li { font-size: 1.2rem; padding: 0.7rem 0.8rem; }
    
              .calendar-widget { padding: 1rem; }
              .calendar-widget h2 { font-size: 1.6rem; }
              .calendar-widget .input-block label { font-size: 1.2rem; }
              .calendar-widget .info-input { font-size: 1.2rem; }
              .date-cell button { font-size: 1.2rem; }
              .day-name { font-size: 1rem; }
    
              .stat-card { padding: 1rem 0.6rem; }
              .stat-card .card-header h3 { font-size: 1.2rem; }
              .stat-card .card-body .value { font-size: 1.8rem; }
              .stat-card .card-body .unit, .stat-card .card-body .description { font-size: 1rem; }
              .stat-card .card-body .sub-value { font-size: 1.1rem; margin-bottom: 0.5rem; }
    
              .graph-controls { padding: 0.6rem; gap: 0.8rem; }
              .control-group { flex-direction: column; align-items: flex-start; gap: 0.4rem; }
              .control-group i { display: none; }
              .control-group label { font-size: 1.15rem; font-weight: 400; }
              .control-group select { font-size: 1.15rem; padding: 0.6rem 0.8rem; width: 100%; }
              .graph-placeholder { padding: 1rem; }
              .chart-area h3 { font-size: 1.3rem; margin-bottom: 1rem; } 
              .canvas-wrapper { height: 260px; } 
    
              .tabs .tab-button { font-size: 1.2rem; padding: 0.7rem 1rem; }
              .nutrition-tab-content h2 { font-size: 1.4rem; }
    
              .footer-links { grid-template-columns: repeat(2, 1fr); gap: 1rem; }
              .footer-links h4 { font-size: 1.4rem; }
              .footer-links a { font-size: 1.3rem; }
              footer { padding: 1.5rem 0; font-size: 1.2rem; }
    
              .modal-content .modal-actions button,
              .modal-content #cancelLogoutButton, .modal-content #okLogoutButton, .modal-content #alertModalOkButton,
              .modal-actions-centered .btn { /* Ensure all modal buttons get this base styling */
                font-size: 1.3rem;
                padding: 0.8rem 1.5rem;
                min-width: 90px;
                width: 100%; /* Make buttons full width in smallest modals */
                margin-bottom: 0.5rem; /* Add some space if they stack */
              }
               .modal-actions-centered .btn:last-child { margin-bottom: 0; }


             #logoutModalMessage, 
             #stopModalMessage, #refundModalMessage,
             #confirmSwitchGymActionModalMessage, 
             #switchGymSuccessModalMessage,
             #refundRequestSubmittedModalMessage,
             #alertModalMessage { font-size: 1.4rem; }

             .modal-content .close-button, .modal-content .modal-close-btn { font-size: 2.2rem; top: 0.8rem; right: 1rem;}
        }
        </style>
</head>
<body>

    <header>
        <a href="home.html" class="logo"><img src="../images/logo.png" alt="OptiLife Logo"></a>
        <div class='bx bx-menu' id="menu-icon"></div>
        <ul class="navbar">
             <div class="navbar-left">
                 <li><a href="../User/home.html">Home</a></li>
                 <li><a href="../User/setGoals.html">Set Goals</a></li>
                 <li><a href="../User/progress.html" class="active">Track Progress</a></li>
                 <li><a href="../User/membership.html">Membership</a></li>
             </div>
             <div class="navbar-right">
                <li class="profile-menu-container">
                     <img src="../images/user_pic.jpg" alt="User Profile" class="profile-pic" id="profilePicTrigger">
                     <ul class="profile-dropdown" id="profileDropdown">
                         <li>
                             <a href="#" id="view-membership-link" class="dropdown-item"> <!-- Changed href -->
                                 <i class='bx bx-id-card'></i> View Membership
                             </a>
                         </li>
                         <li>
                             <a href="#" id="request-refund-link" class="dropdown-item">
                                 <i class='bx bx-revision'></i> Request Refund
                             </a>
                         </li>
                         <li>
                             <a href="#" id="switch-gym-link" class="dropdown-item">
                                 <i class='bx bx-transfer-alt'></i> Switch Gym
                             </a>
                         </li>
                     </ul>
                 </li>
                 <li>
                     <span class="welcome-text">Welcome, <span id="header-user-name">Han Soyoung</span>!</span>
                 </li>
                 <li>
                     <a href="signin.html" id="logout-link">
                         <i class='bx bx-log-out'></i>
                         Logout
                     </a>
                 </li>
             </div>
        </ul>
    </header>

    <main class="content-grid">
         <aside class="calendar-widget card">
            <h2>Select Date</h2>
            <div class="calendar-header">
                <button class="cal-nav prev" aria-label="Previous month"><</button>
                <span class="current-month-year">April 2025</span>
                <button class="cal-nav next" aria-label="Next month">></button>
            </div>
            <div class="calendar-grid">
                <div class="day-name">S</div> <div class="day-name">M</div> <div class="day-name">T</div>
                <div class="day-name">W</div> <div class="day-name">T</div> <div class="day-name">F</div>
                <div class="day-name">S</div>
                <div class="date-cell empty"></div> <div class="date-cell empty"></div>
                <div class="date-cell"><button>1</button></div> <div class="date-cell"><button>2</button></div>
                <div class="date-cell"><button>3</button></div> <div class="date-cell"><button>4</button></div>
                <div class="date-cell"><button>5</button></div> <div class="date-cell"><button>6</button></div>
                <div class="date-cell"><button>7</button></div> <div class="date-cell"><button>8</button></div>
                <div class="date-cell"><button>9</button></div> <div class="date-cell"><button>10</button></div>
                <div class="date-cell"><button>11</button></div> <div class="date-cell"><button>12</button></div>
                <div class="date-cell"><button>13</button></div> <div class="date-cell"><button data-date="2025-04-14">14</button></div>
                <div class="date-cell"><button class="selected" data-date="2025-04-15">15</button></div>
                <div class="date-cell"><button data-date="2025-04-16">16</button></div> <div class="date-cell"><button data-date="2025-04-17">17</button></div>
                <div class="date-cell"><button data-date="2025-04-18">18</button></div> <div class="date-cell"><button data-date="2025-04-19">19</button></div>
                <div class="date-cell"><button data-date="2025-04-20">20</button></div> <div class="date-cell"><button data-date="2025-04-21">21</button></div>
                <div class="date-cell"><button data-date="2025-04-22">22</button></div> <div class="date-cell"><button data-date="2025-04-23">23</button></div>
                <div class="date-cell"><button data-date="2025-04-24">24</button></div> <div class="date-cell"><button data-date="2025-04-25">25</button></div>
                <div class="date-cell"><button data-date="2025-04-26">26</button></div>
                <div class="date-cell"><button data-date="2025-04-27">27</button></div> <div class="date-cell"><button data-date="2025-04-28">28</button></div>
                <div class="date-cell"><button data-date="2025-04-29">29</button></div> <div class="date-cell"><button data-date="2025-04-30">30</button></div>
                <div class="date-cell empty"></div>
            </div>

            <div class="input-block">
                <label for="startDate">Start Date</label>
                <input type="date" id="startDate" name="startDate" class="info-input" value="2025-01-15">
            </div>

            <div class="input-block">
                <label>Goals</label>
                <ul class="goals-list">
                    <li>Improved overall fitness</li>
                    <li>Increased muscle strength</li>
                </ul>
             </div>
        </aside>

         <section class="main-tab-content card">
            <nav class="main-content-tabs">
                <button class="main-tab-button active" data-target="#tabs-1">
                    <i class='bx bx-list-ul'></i> Workout Log
                </button>
                <button class="main-tab-button" data-target="#tabs-2">
                    <i class='bx bx-line-chart'></i> Workout Status
                </button>
                 <button class="main-tab-button" data-target="#tabs-3">
                    <i class='bx bx-restaurant'></i> Nutrition Status
                </button>
            </nav>

            <div id="tabs-1" class="tab-content active">
                <div class="content-placeholder">
                    <h1>Workout Log Details</h1>
                    <div class="input-block workout-type-block">
                        <p class="workout-type">Workout Type: Upper Body and Lower Body Split </p>
                    </div>
                    <div class="workout-table-container">
                        <table class="workout-table">
                            <thead>
                                <tr>
                                    <th scope="col" class="date-col">Date</th>
                                    <th scope="col">Exercise</th>
                                    <th scope="col">Sets</th>
                                    <th scope="col">Reps</th>
                                    <th scope="col">Weight</th>
                                    <th scope="col">Duration</th>
                                    <th scope="col">Notes</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td data-label="Date" class="date-col">Apr 14, 2025</td>
                                    <td data-label="Exercise">Squats</td>
                                    <td data-label="Sets">3</td>
                                    <td data-label="Reps">10-12</td>
                                    <td data-label="Weight">Bodyweight / 10 lbs</td>
                                    <td data-label="Duration">15 min</td>
                                    <td data-label="Notes" class="notes-cell">Focus on form</td>
                                </tr>
                                <tr>
                                     <td data-label="Date" class="date-col">Apr 14, 2025</td>
                                    <td data-label="Exercise">Push-ups</td>
                                    <td data-label="Sets">3</td>
                                    <td data-label="Reps">AMRAP</td>
                                    <td data-label="Weight">Bodyweight</td>
                                    <td data-label="Duration">10 min</td>
                                    <td data-label="Notes" class="notes-cell">Modify on knees if needed</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <section class="daily-log-section">
                        <h3>Daily Activity Summary</h3>
                        <div class="exercise-log-entry-fields">
                            <h4>Log Exercise Details</h4>
                            <div class="exercise-log-entry-grid">
                                <div class="exercise-log-form-group">
                                    <label for="logExerciseName">Exercise Name</label>
                                    <input type="text" id="logExerciseName" name="logExerciseName" class="log-input-field" placeholder="e.g., Squats" required>
                                </div>
                                <div class="exercise-log-form-group">
                                    <label for="logSets">Sets</label>
                                    <input type="number" id="logSets" name="logSets" class="log-input-field" placeholder="e.g., 3" required>
                                </div>
                                <div class="exercise-log-form-group">
                                    <label for="logReps">Reps</label>
                                    <input type="number" id="logReps" name="logReps" class="log-input-field" placeholder="e.g., 10-12" required>
                                </div>
                                <div class="exercise-log-form-group">
                                    <label for="logWeight">Weight</label>
                                    <input type="number" id="logWeight" name="logWeight" class="log-input-field" placeholder="e.g., 10 lbs" required>
                                </div>
                                <div class="exercise-log-form-group">
                                    <label for="logDuration">Duration</label>
                                    <input type="text" id="logDuration" name="logDuration" class="log-input-field" placeholder="e.g., 15 min">
                                </div>
                                <div class="exercise-log-form-group full-width">
                                    <label for="logExerciseNotes">Exercise Notes</label>
                                    <textarea id="logExerciseNotes" name="logExerciseNotes" rows="3" class="log-input-field" placeholder="e.g., Focus on form"></textarea>
                                </div>
                            </div>
                            <button type="button" id="addExerciseToLogBtn" class="action-button">
                                <i class='bx bx-plus-circle'></i> Add Exercise to Log
                            </button>
                        </div>


                        <div class="general-summary-area">
                            <label for="dailySummaryNotes">Overall Daily Notes / How were your goals met?</label>
                            <textarea id="dailySummaryNotes" name="dailySummaryNotes" rows="4" placeholder="Example: Managed 45 mins of total workout..."></textarea>
                        </div>
                        <button type="button" id="saveFullLogBtn" class="action-button">
                            <i class='bx bx-save'></i> Save Notes
                        </button>
                    </section>

                    <section class="coach-feedback-section">
                        <h3>Coach Feedback</h3>
                        <div class="coach-comments-display">
                            <div class="coach-comment-item">
                                <p>Great job on consistency this week, Alex!...</p>
                                <div class="comment-meta"><span class="coach-name">Coach Yoo Joonghyuk</span> - April 15, 2025</div>
                            </div>
                        </div>
                        <div class="coach-comment-input-area">
                            <label for="coachComment">Add a comment (Coach View):</label>
                            <textarea id="coachComment" name="coachComment" rows="4" placeholder="Enter feedback..."></textarea>
                        </div>
                        <button type="button" id="submitCoachFeedbackBtn" class="action-button">
                            <i class='bx bx-send'></i> Submit Feedback
                        </button>
                    </section>
                </div>
            </div>

            <div id="tabs-2" class="tab-content">
                 <div class="content-placeholder">
                    <h1>Workout Status</h1>
                    <section class="card-container">
                        <article class="card stat-card">
                            <div class="card-header"><h3>Calories Burned</h3><i class='bx bxs-hot'></i></div>
                            <div class="card-body"><p class="value">12000.00 <span class="unit">kcal</span></p><p class="sub-value increase">(+10%)</p><p class="description">Total calories burned this month</p></div>
                        </article>
                        <article class="card stat-card">
                            <div class="card-header"><h3>Workouts</h3><i class='bx bx-dumbbell'></i></div>
                            <div class="card-body"><p class="value">5.00</p><p class="sub-value increase">(+1 workout)</p><p class="description">Workouts completed this week</p></div>
                        </article>
                        <article class="card stat-card">
                            <div class="card-header"><h3>Avg. Duration</h3><i class='bx bx-time-five'></i></div>
                            <div class="card-body"><p class="value">45.00 <span class="unit">min</span></p><p class="sub-value decrease">(-5 min)</p><p class="description">Average duration per workout</p></div>
                        </article>
                    </section>
                    <div class="input-block graph-controls">
                        <div class="control-group"><i class='bx bx-line-chart'></i><label for="measurements">Measurements: </label><select name="measurements" id="measurements"><option value="weight" data-unit="kg">Weight</option><option value="neck" data-unit="cm">Neck</option><option value="waist" data-unit="cm">Waist</option><option value="hips" data-unit="cm">Hips</option></select></div>
                        <div class="control-group"><i class='bx bxs-calendar-check'></i><label for="graph-period">Period: </label><select name="graph-period" id="graph-period"><option value="weekly" selected>1 Week</option><option value="monthly">1 Month</option><option value="3months">3 Months</option><option value="6months">6 Months</option><option value="yearly">1 Year</option><option value="start">Since Start</option></select></div>
                    </div>
                    <div class="graph-placeholder"><div class="chart-area"><h3 id="chart-title">Weight Progress (1 Week)</h3><div class="canvas-wrapper"><canvas id="progressChart"></canvas></div></div></div>
                 </div>
            </div>

            <div id="tabs-3" class="tab-content">
                <div class="content-placeholder">
                    <h1>Nutrition Status</h1>
                    <nav class="tabs">
                        <button class="tab-button active" data-tab="calories">CALORIES</button>
                        <button class="tab-button" data-tab="nutrients">NUTRIENTS</button>
                        <button class="tab-button" data-tab="macros">MACROS</button>
                    </nav>

                    <div id="calories-content" class="nutrition-tab-content active">
                         <h2>Calories Breakdown</h2>
                        <div class="chart-placeholder-container"><canvas id="calorieChart"></canvas></div>
                        <div class="calories-breakdown">
                            <div class="meal-item"><span class="color-square calorie-breakfast" style="background-color: #bf9a33;"></span><div class="meal-info"><div>Breakfast</div><div data-value="breakfast-calories">0% (0 cal)</div></div></div>
                            <div class="meal-item"><span class="color-square calorie-lunch" style="background-color: #febd14;"></span><div class="meal-info"><div>Lunch</div><div data-value="lunch-calories">0% (0 cal)</div></div></div>
                            <div class="meal-item"><span class="color-square calorie-dinner" style="background-color: #fece43;"></span><div class="meal-info"><div>Dinner</div><div data-value="dinner-calories">0% (0 cal)</div></div></div>
                            <div class="meal-item"><span class="color-square calorie-snacks" style="background-color: #feda75;"></span><div class="meal-info"><div>Snacks</div><div data-value="snack-calories">0% (0 cal)</div></div></div>
                        </div>
                        <div class="calorie-summary">
                            <div class="summary-item"><span>Total Calories</span><span data-value="total-calories">0</span></div>
                            <div class="summary-item"><span>Exercise</span><span data-value="exercise-calories" class="exercise">0</span></div>
                            <div class="summary-item net-calories-item"><span>Net Calories</span><span data-value="net-calories">0</span></div>
                            <hr class="summary-divider">
                            <div class="summary-item goal"><span>Goal</span><span data-value="goal-calories">1,520</span></div>
                        </div>

                        <section class="meal-logging-section">
                            <h3>Log Your Meals for <span id="selectedDateForMealLog">Today</span></h3>
                            <div class="meal-log-group" id="breakfastLogGroup">
                                <h4><i class='bx bx-sun'></i> Breakfast</h4>
                                <form class="food-item-entry-form">
                                    <div class="food-name-group"><label for="breakfast-food-name">Food</label><input type="text" id="breakfast-food-name" class="log-input-field food-name" placeholder="Food item"></div>
                                    <div><label for="breakfast-food-calories">Cals</label><input type="number" id="breakfast-food-calories" class="log-input-field food-calories" placeholder="Cals"></div>
                                    <div><label for="breakfast-food-protein">P(g)</label><input type="number" id="breakfast-food-protein" class="log-input-field food-protein" placeholder="P (g)"></div>
                                    <div><label for="breakfast-food-carbs">C(g)</label><input type="number" id="breakfast-food-carbs" class="log-input-field food-carbs" placeholder="C (g)"></div>
                                    <div><label for="breakfast-food-fat">F(g)</label><input type="number" id="breakfast-food-fat" class="log-input-field food-fat" placeholder="F (g)"></div>
                                    <button type="button" class="action-button add-food-item-btn" data-meal="breakfast"><i class='bx bx-plus'></i> Add</button>
                                </form>
                                <ul class="logged-food-list breakfast-list"></ul>
                            </div>
                            <div class="meal-log-group" id="lunchLogGroup">
                                <h4><i class='bx bxs-pizza'></i> Lunch</h4>
                                <form class="food-item-entry-form">
                                    <div class="food-name-group"><label for="lunch-food-name">Food</label><input type="text" id="lunch-food-name" class="log-input-field food-name" placeholder="Food item"></div>
                                    <div><label for="lunch-food-calories">Cals</label><input type="number" id="lunch-food-calories" class="log-input-field food-calories" placeholder="Cals"></div>
                                    <div><label for="lunch-food-protein">P(g)</label><input type="number" id="lunch-food-protein" class="log-input-field food-protein" placeholder="P (g)"></div>
                                    <div><label for="lunch-food-carbs">C(g)</label><input type="number" id="lunch-food-carbs" class="log-input-field food-carbs" placeholder="C (g)"></div>
                                    <div><label for="lunch-food-fat">F(g)</label><input type="number" id="lunch-food-fat" class="log-input-field food-fat" placeholder="F (g)"></div>
                                    <button type="button" class="action-button add-food-item-btn" data-meal="lunch"><i class='bx bx-plus'></i> Add</button>
                                </form>
                                <ul class="logged-food-list lunch-list"></ul>
                            </div>
                            <div class="meal-log-group" id="dinnerLogGroup">
                                <h4><i class='bx bx-bowl-rice'></i> Dinner</h4>
                                <form class="food-item-entry-form">
                                    <div class="food-name-group"><label for="dinner-food-name">Food</label><input type="text" id="dinner-food-name" class="log-input-field food-name" placeholder="Food item"></div>
                                    <div><label for="dinner-food-calories">Cals</label><input type="number" id="dinner-food-calories" class="log-input-field food-calories" placeholder="Cals"></div>
                                    <div><label for="dinner-food-protein">P(g)</label><input type="number" id="dinner-food-protein" class="log-input-field food-protein" placeholder="P (g)"></div>
                                    <div><label for="dinner-food-carbs">C(g)</label><input type="number" id="dinner-food-carbs" class="log-input-field food-carbs" placeholder="C (g)"></div>
                                    <div><label for="dinner-food-fat">F(g)</label><input type="number" id="dinner-food-fat" class="log-input-field food-fat" placeholder="F (g)"></div>
                                    <button type="button" class="action-button add-food-item-btn" data-meal="dinner"><i class='bx bx-plus'></i> Add</button>
                                </form>
                                <ul class="logged-food-list dinner-list"></ul>
                            </div>
                            <div class="meal-log-group" id="snacksLogGroup">
                                <h4><i class='bx bx-cookie'></i> Snacks</h4>
                                <form class="food-item-entry-form">
                                    <div class="food-name-group"><label for="snacks-food-name">Food</label><input type="text" id="snacks-food-name" class="log-input-field food-name" placeholder="Food item"></div>
                                    <div><label for="snacks-food-calories">Cals</label><input type="number" id="snacks-food-calories" class="log-input-field food-calories" placeholder="Cals"></div>
                                    <div><label for="snacks-food-protein">P(g)</label><input type="number" id="snacks-food-protein" class="log-input-field food-protein" placeholder="P (g)"></div>
                                    <div><label for="snacks-food-carbs">C(g)</label><input type="number" id="snacks-food-carbs" class="log-input-field food-carbs" placeholder="C (g)"></div>
                                    <div><label for="snacks-food-fat">F(g)</label><input type="number" id="snacks-food-fat" class="log-input-field food-fat" placeholder="F (g)"></div>
                                    <button type="button" class="action-button add-food-item-btn" data-meal="snacks"><i class='bx bx-plus'></i> Add</button>
                                </form>
                                <ul class="logged-food-list snacks-list"></ul>
                            </div>
                            <button type="button" id="updateNutritionSummaryBtn" class="action-button">
                                <i class='bx bx-refresh'></i> Update Full Nutrition Summary
                            </button>

                            <section class="coach-feedback-section">
                                <h3>Coach Feedback</h3>
                                <div class="coach-comments-display">
                                    <div class="coach-comment-item">
                                        <p>Good effort on the diet. That unplanned snack is okay...</p>
                                        <div class="comment-meta"><span class="coach-name">Coach Yoo Joonghyuk</span> - April 15, 2025</div>
                                    </div>
                                </div>
                                <div class="coach-comment-input-area">
                                    <label for="coachComment_nutrition">Add a comment (Coach View):</label>
                                    <textarea id="coachComment_nutrition" name="coachComment_nutrition" rows="4" placeholder="Enter feedback..."></textarea>
                                </div>
                                <button type="button" id="submitCoachFeedbackBtn_nutrition" class="action-button">
                                    <i class='bx bx-send'></i> Submit Feedback
                                </button>
                            </section>
                        </section>
                    </div>

                    <div id="nutrients-content" class="nutrition-tab-content">
                        <h2>Nutrient Details</h2>
                        <div class="nutrition-details-full">
                            <div class="nutrient-header"><span>Nutrient</span><span>Total</span><span>Goal</span><span>Left</span></div>
                            <ul class="nutrient-list">
                                <li data-nutrient="protein"><span>Protein</span><span data-value="protein-total">0 g</span><span data-value="protein-goal">76 g</span><span data-value="protein-left">76 g</span></li>
                                <li data-nutrient="carbohydrates"><span>Carbohydrates</span><span data-value="carbs-total">0 g</span><span data-value="carbs-goal">190 g</span><span data-value="carbs-left">190 g</span></li>
                                <li data-nutrient="fiber"><span>Fiber</span><span data-value="fiber-total">0 g</span><span data-value="fiber-goal">25 g</span><span data-value="fiber-left">25 g</span></li>
                                <li data-nutrient="sugar"><span>Sugar</span><span data-value="sugar-total">0 g</span><span data-value="sugar-goal">57 g</span><span data-value="sugar-left">57 g</span></li>
                                <li data-nutrient="fat"><span>Fat</span><span data-value="fat-total">0 g</span><span data-value="fat-goal">51 g</span><span data-value="fat-left">51 g</span></li>
                                <li data-nutrient="saturated_fat"><span>Saturated Fat</span><span data-value="satfat-total">0 g</span><span data-value="satfat-goal">17 g</span><span data-value="satfat-left">17 g</span></li>
                                <li data-nutrient="polyunsaturated_fat"><span>Polyunsaturated Fat</span><span data-value="polyfat-total">0 g</span><span data-value="polyfat-goal">0 g</span><span data-value="polyfat-left">0 g</span></li>
                                <li data-nutrient="monounsaturated_fat"><span>Monounsaturated Fat</span><span data-value="monofat-total">0 g</span><span data-value="monofat-goal">0 g</span><span data-value="monofat-left">0 g</span></li>
                                <li data-nutrient="trans_fat"><span>Trans Fat</span><span data-value="transfat-total">0 g</span><span data-value="transfat-goal">0 g</span><span data-value="transfat-left">0 g</span></li>
                                <li data-nutrient="cholesterol"><span>Cholesterol</span><span data-value="cholesterol-total">0 mg</span><span data-value="cholesterol-goal">300 mg</span><span data-value="cholesterol-left">300 mg</span></li>
                                <li data-nutrient="sodium"><span>Sodium</span><span data-value="sodium-total">0 mg</span><span data-value="sodium-goal">2,300 mg</span><span data-value="sodium-left">2,300 mg</span></li>
                                <li data-nutrient="potassium"><span>Potassium</span><span data-value="potassium-total">0 mg</span><span data-value="potassium-goal">3,500 mg</span><span data-value="potassium-left">3,500 mg</span></li>
                                <li data-nutrient="vitamin_a"><span>Vitamin A</span><span data-value="vita-total">0 %</span><span data-value="vita-goal">100 %</span><span data-value="vita-left">100 %</span></li>
                                <li data-nutrient="vitamin_c"><span>Vitamin C</span><span data-value="vitc-total">0 %</span><span data-value="vitc-goal">100 %</span><span data-value="vitc-left">100 %</span></li>
                                <li data-nutrient="calcium"><span>Calcium</span><span data-value="calcium-total">0 %</span><span data-value="calcium-goal">100 %</span><span data-value="calcium-left">100 %</span></li>
                                <li data-nutrient="iron"><span>Iron</span><span data-value="iron-total">0 %</span><span data-value="iron-goal">100 %</span><span data-value="iron-left">100 %</span></li>
                            </ul>
                        </div>
                    </div>

                    <div id="macros-content" class="nutrition-tab-content">
                         <h2>Macronutrient Ratio</h2>
                        <div class="chart-placeholder-container"><canvas id="macroChart"></canvas></div>
                        <div class="macros-legend">
                             <div class="legend-item" data-macro="carbs"><span class="color-square macro-carbs" style="background-color: #febd14;"></span><span>Carbohydrates (<span data-value="carbs-grams">0g</span>)</span><span class="percentage" data-value="carbs-percentage">0%</span><span class="goal-percentage">50%</span></div>
                             <div class="legend-item" data-macro="fat"><span class="color-square macro-fat" style="background-color: #fece43;"></span><span>Fat (<span data-value="fat-grams">0g</span>)</span><span class="percentage" data-value="fat-percentage">0%</span><span class="goal-percentage">30%</span></div>
                             <div class="legend-item" data-macro="protein"><span class="color-square macro-protein" style="background-color: #feda75;"></span><span>Protein (<span data-value="protein-grams">0g</span>)</span><span class="percentage" data-value="protein-percentage">0%</span><span class="goal-percentage">20%</span></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Logout Confirmation Modal -->
    <div id="logoutConfirmationModal" class="modal">
        <div class="modal-content">
            <button id="closeLogoutModalButton" class="close-button" aria-label="Close modal">×</button> <!-- Changed from modal-close-btn to close-button -->
            <p id="logoutModalMessage">Are you sure you want to logout?</p>
            <div class="modal-actions"> <!-- Changed from modal-actions-centered to modal-actions -->
                 <button id="cancelLogoutButton" class="btn-secondary">Cancel</button> 
                 <button id="okLogoutButton" class="btn-primary">Logout</button>
            </div>
        </div>
    </div>

    <!-- View Membership Modal -->
    <div id="viewMembershipModal" class="modal">
        <div class="modal-content">
            <button id="closeViewMembershipModalButton" class="modal-close-btn" aria-label="Close modal">×</button>
            <h2>Your Current Membership</h2>
            <div class="status-details">
                <p class="status-text">
                    Plan: <span class="current-status" id="modal-user-membership-plan">Premium</span>
                </p>
                <p class="status-text">
                    Expires: <span class="expiry-date" id="modal-user-membership-expiry">March 15, 2025</span>
                </p>
                <p class="status-note">
                    Manage your subscription below. Extending adds time to your current expiry date.
                </p>
            </div>
            <div class="status-actions">
                <a href="paymentMethods.html?action=extend" id="modal-extend-membership-link" class="btn btn-primary">Extend Membership</a>
                <button type="button" id="modal-stop-membership-button" class="btn btn-secondary">Stop Membership</button>
            </div>
        </div>
    </div>
  
    <!-- Stop Membership Confirmation Modal -->
    <div id="stopMembershipModal" class="modal">
        <div class="modal-content">
            <button id="closeStopModalButton" class="modal-close-btn" aria-label="Close modal">×</button>
            <h3>Confirm Membership Cancellation</h3>
            <p id="stopModalMessage">Are you sure you want to stop your membership at the end of the current period? This action cannot be undone easily.</p>
            <div class="modal-actions-centered">
                 <button id="cancelStopMembershipBtn" class="btn btn-dark-cancel">Keep Membership</button>
                 <button id="confirmStopMembershipBtn" class="btn btn-primary btn-danger">Confirm Stop</button>
            </div>
        </div>
    </div>
  
    <!-- Request Refund Modal -->
    <div id="requestRefundModal" class="modal">
        <div class="modal-content">
            <button id="closeRequestRefundModalButton" class="modal-close-btn" aria-label="Close modal">×</button>
            <h3>Request a Refund</h3>
            <form id="requestRefundForm">
                <div class="form-group">
                    <label for="refund-reason">Reason for Refund:</label>
                    <textarea id="refund-reason" name="refundReason" placeholder="Please explain why you are requesting a refund..."></textarea>
                    <span class="error-message" id="refund-reason-error"></span>
                </div>
                <div class="modal-actions-centered">
                    <button type="button" id="cancelRefundRequestBtn" class="btn btn-dark-cancel">Cancel</button>
                    <button type="submit" id="submitRefundRequestBtn" class="btn btn-primary">Submit Request</button>
                </div>
            </form>
        </div>
    </div>
  
    <!-- Refund Request Submitted Modal -->
    <div id="refundRequestSubmittedModal" class="modal">
      <div class="modal-content">
          <button id="closeRefundRequestSubmittedModalButton" class="modal-close-btn" aria-label="Close modal">×</button>
          <h3>Refund Request Submitted</h3>
          <p id="refundRequestSubmittedModalMessage">
              Your refund request has been submitted. We will review it and get back to you soon.
          </p>
          <div class="modal-actions-centered">
              <button id="okRefundSubmittedButton" class="btn btn-primary">OK</button>
          </div>
      </div>
    </div>
  
    <!-- Switch Gym Modal (Form) -->
    <div id="switchGymModal" class="modal">
        <div class="modal-content">
            <button id="closeSwitchGymModalButton" class="modal-close-btn" aria-label="Close modal">×</button>
            <h3>Switch Your Gym</h3>
            <form id="switchGymForm">
                <div class="form-group">
                    <label for="gym-select">Select Gym:</label>
                    <select id="gym-select" name="gym">
                        <option value="">-- Select Gym Name --</option>
                        <option value="near">Gym Near You (Autodetect)</option>
                        <option value="elite">Elite Fitness Hub</option>
                        <option value="iron">Iron Haven</option>
                        <option value="elevate">Elevate Athletics</option>
                    </select>
                    <span class="error-message" id="gym-select-error"></span>
                </div>
                <div class="form-group">
                    <label for="location-select">Select Location (if not autodetected):</label>
                    <select id="location-select" name="location">
                        <option value="">-- Select Location --</option>
                        <option value="boulder">1760 Pearl Street, Boulder, CO 80302, USA</option>
                        <option value="manchester">52 Portland Street, Manchester M1 4QU, United Kingdom</option>
                        <option value="qc">102 Timog Avenue, Barangay Sacred Heart, Quezon City, Metro Manila 1103, Philippines</option>
                    </select>
                    <span class="error-message" id="location-select-error"></span>
                </div>
                <div class="modal-actions"> <!-- Use .modal-actions for form buttons -->
                    <button type="button" id="cancelSwitchGymBtn" class="btn btn-dark-cancel">Cancel</button>
                    <button type="submit" id="confirmSwitchGymBtn" class="btn btn-primary">Confirm Switch</button>
                </div>
            </form>
        </div>
    </div>
  
    <!-- Confirm Switch Gym Action Modal -->
    <div id="confirmSwitchGymActionModal" class="modal">
        <div class="modal-content">
            <button id="closeConfirmSwitchGymActionModalButton" class="modal-close-btn" aria-label="Close modal">×</button>
            <h3>Confirm Gym Switch</h3>
            <p id="confirmSwitchGymActionModalMessage">
                You are about to switch to:
                <strong id="confirmGymNameText"></strong>
                at location:
                <strong id="confirmGymLocationText"></strong>
                Are you sure you want to proceed?
            </p>
            <div class="modal-actions-centered">
                <button type="button" id="cancelSwitchGymActionBtn" class="btn btn-dark-cancel">Cancel</button>
                <button type="button" id="confirmSwitchGymActionActualBtn" class="btn btn-primary">Yes, Switch Gym</button>
            </div>
        </div>
    </div>
  
    <!-- Switch Gym Success Modal -->
    <div id="switchGymSuccessModal" class="modal">
        <div class="modal-content">
            <button id="closeSwitchGymSuccessModalButton" class="modal-close-btn" aria-label="Close modal">×</button>
            <h3>Switch Successful</h3>
            <p id="switchGymSuccessModalMessage">
                Your gym switch request has been submitted.
            </p>
            <div class="modal-actions-centered">
                <button type="button" id="okSwitchGymSuccessBtn" class="btn btn-primary">OK</button>
            </div>
        </div>
    </div>


    <section id="subscribe" class="subscribe-section">
        <div class="container subscribe-content">
             <div class="subscribe-text">
                <h2>Subscribe</h2>
                <p>Join our fitness family and get tips, exclusive updates, and special offers. Start your journey today!</p>
                <form class="subscribe-form" id="subscribeForm">
                    <input type="email" id="subscribeEmail" placeholder="Email" required>
                    <button type="submit" class="btn btn-primary">Send</button>
                </form>
                <div class="social-icons">
                    <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="#" aria-label="TikTok"><i class="fab fa-tiktok"></i></a>
                    <a href="#" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                </div>
            </div>
            <div class="footer-links">
                 <div><h4>Company</h4><ul><li><a href="#">Press</a></li><li><a href="#">Blog</a></li><li><a href="#">About</a></li><li><a href="#">Careers</a></li></ul></div> <div><h4>Services</h4><ul><li><a href="#">Training</a></li><li><a href="#">Nutrition</a></li><li><a href="#">Lifestyles</a></li></ul></div> <div><h4>Legal</h4><ul><li><a href="#">Policy</a></li><li><a href="#">Privacy & Cookies</a></li><li><a href="#">Terms & Conditions</a></li></ul></div> <div><h4>Community</h4><ul><li><a href="#">Contact</a></li><li><a href="#">Find a club</a></li><li><a href="#">Membership</a></li></ul></div> <div><h4>Gym</h4><ul><li><a href="#">Book a Gym</a></li><li><a href="#">Find a Gym</a></li></ul></div>
                 <div>
                    <h4>System Developed By</h4>
                    <ul>
                        <li><a href="#">Sintoy, Joebert</a></li>
                        <li><a href="#">Paliqueron, Khem</a></li>
                        <li><a href="#">Iglesia, Jose</a></li>
                    </ul>
                </div>
                
            </div>
        </div>
    </section>
    <footer>
        <div class="container">
            <p>© 2024 OPTILIFE. All Rights Reserved.</p>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-moment@1.0.1/dist/chartjs-adapter-moment.min.js"></script>

    <script>
        $(document).ready(function() {
            var menuIcon = $('#menu-icon');
            var navbar = $('.navbar');
            var logoutLink = $('#logout-link');
            var logoutModal = $('#logoutConfirmationModal');
            const $profilePicTrigger = $('#profilePicTrigger');
            const $profileDropdown = $('#profileDropdown');
            
            // New Modal Triggers from profile dropdown
            const $viewMembershipLink = $('#view-membership-link');
            const $requestRefundLink = $('#request-refund-link');
            const $switchGymLink = $('#switch-gym-link');

            // New Modal Elements
            const $viewMembershipModal = $('#viewMembershipModal');
            const $modalStopMembershipButton = $('#modal-stop-membership-button'); // Button inside viewMembershipModal
            const $stopMembershipModal = $('#stopMembershipModal');
            
            const $requestRefundModal = $('#requestRefundModal');
            const $refundRequestSubmittedModal = $('#refundRequestSubmittedModal');
            
            const $switchGymModal = $('#switchGymModal'); 
            const $confirmSwitchGymActionModal = $('#confirmSwitchGymActionModal');
            const $switchGymSuccessModal = $('#switchGymSuccessModal');


            function closeOverlays() {
                if ($profileDropdown.hasClass('active')) { 
                    $profileDropdown.removeClass('active');
                    $profilePicTrigger.removeClass('active');
                }
                if (navbar.hasClass('active') && $(window).width() <= 991) {
                    navbar.removeClass('active');
                    menuIcon.removeClass('bx-x');
                }
            }

            if (menuIcon.length && navbar.length) {
                menuIcon.on('click', function() {
                    $(this).toggleClass('bx-x');
                    navbar.toggleClass('active');
                    if ($profileDropdown.hasClass('active') && $(window).width() > 991) {
                        $profileDropdown.removeClass('active');
                        $profilePicTrigger.removeClass('active');
                    }
                });
                $(window).on('scroll', function() { closeOverlays(); });
            }

            if ($profilePicTrigger.length && $profileDropdown.length) {
                $profilePicTrigger.on('click', function(event) {
                    event.stopPropagation();
                    $profileDropdown.toggleClass('active'); 
                    $profilePicTrigger.toggleClass('active'); 
                    if (navbar.hasClass('active') && $(window).width() > 991) { 
                         navbar.removeClass('active');
                         menuIcon.removeClass('bx-x');
                    }
                });
                $(document).on('click', function(event) { 
                    if (!$profileDropdown.is(event.target) && $profileDropdown.has(event.target).length === 0 && !$profilePicTrigger.is(event.target)) {
                        if ($profileDropdown.hasClass('active')) { 
                            $profileDropdown.removeClass('active');
                            $profilePicTrigger.removeClass('active');
                        }
                    }
                });
            }

            navbar.on('click', 'a', function(event) {
                const $clickedLink = $(this);
                // Check if it's a modal trigger link from the dropdown
                const isModalTrigger = $clickedLink.is($viewMembershipLink) ||
                                     $clickedLink.is($requestRefundLink) ||
                                     $clickedLink.is($switchGymLink);

                if ($clickedLink.is($profilePicTrigger)) {
                    return; // Profile pic has its own toggle logic
                }
                
                // If it's a modal trigger, prevent default page jump
                if (isModalTrigger && $clickedLink.attr('href') === '#') {
                    event.preventDefault();
                }

                if (navbar.hasClass('active') && $(window).width() <= 991) {
                    navbar.removeClass('active');
                    menuIcon.removeClass('bx-x');
                    if ($profileDropdown.hasClass('active')) { // also ensure desktop dropdown is closed
                        $profileDropdown.removeClass('active');
                        $profilePicTrigger.removeClass('active');
                    }
                } else if ($profileDropdown.hasClass('active') && $clickedLink.closest($profileDropdown).length) {
                    // If it's a link within the *desktop* dropdown (and not a modal trigger that needs to stay on page)
                    // or if it IS a modal trigger, we want to close the dropdown after it's handled.
                    $profileDropdown.removeClass('active');
                    $profilePicTrigger.removeClass('active');
                }
                // Modal opening logic is handled by specific link click handlers below
            });


            // --- View Membership Modal ---
            if ($viewMembershipLink.length && $viewMembershipModal.length) {
                $viewMembershipLink.on('click', function(event) {
                    event.preventDefault();
                    closeOverlays();
                    loadMembershipStatus(); 
                    $viewMembershipModal.addClass('active');
                });
                $viewMembershipModal.on('click', '#closeViewMembershipModalButton', function() {
                     $viewMembershipModal.removeClass('active');
                });
                if ($modalStopMembershipButton.length && $stopMembershipModal.length) {
                    $modalStopMembershipButton.on('click', function() {
                        $viewMembershipModal.removeClass('active'); 
                        $stopMembershipModal.addClass('active');    
                    });
                }
            }
            // --- Stop Membership Modal ---
            if ($stopMembershipModal.length) {
                $stopMembershipModal.on('click', '#closeStopModalButton, #cancelStopMembershipBtn', function() {
                     $stopMembershipModal.removeClass('active');
                });
                $('#confirmStopMembershipBtn').on('click', function() {
                     console.log("Membership stop confirmed (placeholder action)");
                     alert("Your request to stop the membership has been processed (placeholder).");
                     $stopMembershipModal.removeClass('active');
                });
            }


            // --- Request Refund Modal Logic ---
            if ($requestRefundLink.length && $requestRefundModal.length && $refundRequestSubmittedModal.length) {
                $requestRefundLink.on('click', function(event) {
                    event.preventDefault();
                    closeOverlays();
                    $('#requestRefundForm')[0].reset(); 
                    $('#refund-reason-error').text(''); 
                    $requestRefundModal.addClass('active');
                });
                $requestRefundModal.on('click', '#closeRequestRefundModalButton, #cancelRefundRequestBtn', function() {
                    $requestRefundModal.removeClass('active');
                });
                $('#requestRefundForm').on('submit', function(event) {
                    event.preventDefault();
                    const reason = $('#refund-reason').val().trim();
                    const $reasonError = $('#refund-reason-error');
                    $reasonError.text(''); 
                    if (!reason) {
                        $reasonError.text('Please enter a reason for your refund request.');
                        return;
                    }
                    console.log("Refund Request Submitted. Reason:", reason);
                    $requestRefundModal.removeClass('active');
                    $refundRequestSubmittedModal.addClass('active');
                });
                $refundRequestSubmittedModal.on('click', '#closeRefundRequestSubmittedModalButton, #okRefundSubmittedButton', function() {
                    $refundRequestSubmittedModal.removeClass('active');
                });
            }

            // --- Switch Gym Modals Logic ---
            if ($switchGymLink.length && $switchGymModal.length && $confirmSwitchGymActionModal.length && $switchGymSuccessModal.length) {
                $switchGymLink.on('click', function(event) {
                    event.preventDefault();
                    closeOverlays();
                    $('#switchGymForm')[0].reset(); 
                    $('#gym-select-error').text(''); 
                    $('#location-select-error').text('');
                    $switchGymModal.addClass('active');
                });
                $switchGymModal.on('click', '#closeSwitchGymModalButton, #cancelSwitchGymBtn', function() {
                    $switchGymModal.removeClass('active');
                });
                $('#switchGymForm').on('submit', function(event) {
                    event.preventDefault();
                    const selectedGymValue = $('#gym-select').val();
                    const selectedGymText = $('#gym-select option:selected').text();
                    const selectedLocationValue = $('#location-select').val();
                    const selectedLocationText = $('#location-select option:selected').text();
                    const $gymError = $('#gym-select-error');
                    const $locationError = $('#location-select-error');
                    let isValid = true;
                    $gymError.text(''); $locationError.text('');
                    if (!selectedGymValue) { $gymError.text('Please select a gym.'); isValid = false; }
                    if (selectedGymValue !== "near" && !selectedLocationValue) { $locationError.text('Please select a location for the chosen gym.'); isValid = false; }
                    if (!isValid) return;
                    $('#confirmGymNameText').text(selectedGymText);
                    $('#confirmGymLocationText').text(selectedLocationValue ? selectedLocationText : (selectedGymValue === "near" ? "Autodetected" : "N/A"));
                    $switchGymModal.removeClass('active'); 
                    $confirmSwitchGymActionModal.addClass('active'); 
                });
                $confirmSwitchGymActionModal.on('click', '#closeConfirmSwitchGymActionModalButton, #cancelSwitchGymActionBtn', function() {
                    $confirmSwitchGymActionModal.removeClass('active');
                });
                $('#confirmSwitchGymActionActualBtn').on('click', function() {
                    const gymText = $('#confirmGymNameText').text();
                    const locationText = $('#confirmGymLocationText').text();
                    console.log("Switch Gym Confirmed. Gym:", gymText, "Location:", locationText);
                    $confirmSwitchGymActionModal.removeClass('active');
                    $('#switchGymSuccessModalMessage').html(`Your gym switch request to <strong>${gymText}</strong> (Location: <strong>${locationText}</strong>) has been submitted.`);
                    $switchGymSuccessModal.addClass('active');
                    $('#switchGymForm')[0].reset(); 
                });
                $switchGymSuccessModal.on('click', '#closeSwitchGymSuccessModalButton, #okSwitchGymSuccessBtn', function() {
                    $switchGymSuccessModal.removeClass('active');
                });
            }

            // --- Logout Modal Logic (already exists, ensure it works with closeOverlays) ---
            if (logoutLink.length && logoutModal.length) {
                logoutLink.on('click', function(event) {
                    event.preventDefault();
                    closeOverlays(); 
                    logoutModal.addClass('active');
                });
                logoutModal.on('click', '.close-button, #cancelLogoutButton', function() { 
                    logoutModal.removeClass('active');
                });
                $('#okLogoutButton').on('click', function() {
                    logoutModal.removeClass('active');
                    window.location.href = logoutLink.attr('href');
                });
            }

            // Generic click outside modal to close
            $(window).on('click', function(event) {
                 if ($(event.target).is('.modal')) { 
                     $(event.target).removeClass('active');
                 }
            });

            function loadMembershipStatus() { // For View Membership Modal
                let userName = "Han Soyoung"; 
                $('#header-user-name').text(userName); // Assuming this is still desired
                const userPlan = "Premium"; 
                const expiryDate = "2025-03-15";
                $('#modal-user-membership-plan').text(userPlan);
                $('#modal-user-membership-expiry').text(moment(expiryDate).format('MMMM D, YYYY'));
            }
            loadMembershipStatus(); // Load initially for header, also called when opening modal


            // ===== REST OF progress.html JavaScript (Tabs, Charts, Logging etc.) =====
            $('.main-tab-button').on('click', function() { var target = $(this).data('target'); $('.main-tab-button').removeClass('active'); $(this).addClass('active'); $('.main-tab-content > .tab-content').removeClass('active'); $(target).addClass('active'); if (target === '#tabs-2') initializeOrUpdateProgressChart(); else if (target === '#tabs-3') { initializeOrUpdateNutritionCharts(); const activeNutriTab = $('#tabs-3 .tabs .tab-button.active').data('tab'); $('#' + activeNutriTab + '-content').addClass('active'); } });
            $('.tabs .tab-button').on('click', function() { var tabId = $(this).data('tab'); var container = $(this).closest('.content-placeholder'); container.find('.tabs .tab-button').removeClass('active'); $(this).addClass('active'); container.find('.nutrition-tab-content').removeClass('active'); $('#' + tabId + '-content').addClass('active'); if (tabId === 'calories' || tabId === 'macros') { $('#updateNutritionSummaryBtn').trigger('click'); } });

            let progressChartInstance, calorieChartInstance, macroChartInstance;
            function getProgressChartData(period, measurement) { let labels = []; let data = []; let unit = $('#measurements option:selected').data('unit') || 'kg'; let startDate = moment().subtract(6, 'days'); let days = 7; if (period === 'monthly') { startDate = moment().subtract(1, 'month'); days = 30; } else if (period === '3months') { startDate = moment().subtract(3, 'months'); days = 90; } else if (period === '6months') { startDate = moment().subtract(6, 'months'); days = 180; } else if (period === 'yearly') { startDate = moment().subtract(1, 'year'); days = 365; } let startValue = 70; if (measurement === 'neck') startValue = 38; else if (measurement === 'waist') startValue = 85; else if (measurement === 'hips') startValue = 100; for (let i = 0; i < days; i++) { labels.push(startDate.clone().add(i, 'days').toDate()); data.push(startValue + (Math.random() * 4 - 2) * (measurement === 'weight' ? 1 : 0.5) - (i * 0.05)); } return { labels, data, unit }; }
            function initializeOrUpdateProgressChart() { const ctx = document.getElementById('progressChart'); if (!ctx) return; const mSelect = $('#measurements'), pSelect = $('#graph-period'), chartTitle = $('#chart-title'); const selM = mSelect.val(), selP = pSelect.val(); const mText = mSelect.find('option:selected').text(), pText = pSelect.find('option:selected').text(); chartTitle.text(`${mText} Progress (${pText})`); const { labels, data, unit } = getProgressChartData(selP, selM); if (progressChartInstance) progressChartInstance.destroy(); progressChartInstance = new Chart(ctx.getContext('2d'), { type: 'line', data: { labels: labels, datasets: [{ label: `${mText} (${unit})`, data: data, borderColor: 'var(--main-color)', backgroundColor: 'rgba(255,215,0,0.1)', borderWidth: 2, tension: 0.1, fill: true }] }, options: { responsive: true, maintainAspectRatio: false, scales: { x: { type: 'time', time: { unit: labels.length > 90 ? 'month' : (labels.length > 7 ? 'week' : 'day'), tooltipFormat: 'll' }, title: { display: true, text: 'Date', color: 'var(--card-muted-text-color)' }, ticks: { color: 'var(--card-muted-text-color)' }, grid: { color: 'var(--card-border-color)' } }, y: { beginAtZero: false, title: { display: true, text: `${mText} (${unit})`, color: 'var(--card-muted-text-color)' }, ticks: { color: 'var(--card-muted-text-color)' }, grid: { color: 'var(--card-border-color)' } } }, plugins: { legend: { labels: { color: 'var(--card-text-color)' } }, tooltip: { mode: 'index', intersect: false, titleColor: 'var(--main-color)', bodyColor: 'var(--card-text-color)', backgroundColor: 'var(--card-bg)', borderColor: 'var(--main-color)', borderWidth: 1 } } } }); }
            $('#measurements, #graph-period').on('change', function() { if ($('#tabs-2').hasClass('active')) initializeOrUpdateProgressChart(); });

            let currentCalorieData = { breakfast: 0, lunch: 0, dinner: 0, snacks: 0 }; let currentMacroData = { carbs: 0, fat: 0, protein: 0 };
            function updateNutritionUI(calorieData, macroData) { const totalCalories = Object.values(calorieData).reduce((sum, val) => sum + val, 0); const exerciseCalories = parseInt($('[data-value="exercise-calories"]').text().replace(/,/g, '')) || 0; $('[data-value="total-calories"]').text(totalCalories.toLocaleString()); $('[data-value="net-calories"]').text((totalCalories - exerciseCalories).toLocaleString()); const mealTargets = { 'breakfast-calories': $('[data-value="breakfast-calories"]'), 'lunch-calories': $('[data-value="lunch-calories"]'), 'dinner-calories': $('[data-value="dinner-calories"]'), 'snack-calories': $('[data-value="snack-calories"]') }; for (const meal in calorieData) { const key = `${meal.toLowerCase()}-calories`; if (mealTargets[key]) { const percentage = totalCalories > 0 ? Math.round((calorieData[meal] / totalCalories) * 100) : 0; mealTargets[key].text(`${percentage}% (${calorieData[meal].toLocaleString()} cal)`); } } $('[data-value="protein-total"]').text(`${macroData.protein.toFixed(1)} g`); $('[data-value="carbs-total"]').text(`${macroData.carbs.toFixed(1)} g`); $('[data-value="fat-total"]').text(`${macroData.fat.toFixed(1)} g`); const proteinGoalGrams = parseFloat($('[data-value="protein-goal"]').text().replace(/[^0-9.]/g, '')) || 0; $('[data-value="protein-left"]').text(`${Math.max(0, proteinGoalGrams - macroData.protein).toFixed(1)} g`); const carbsGoalGrams = parseFloat($('[data-value="carbs-goal"]').text().replace(/[^0-9.]/g, '')) || 0; $('[data-value="carbs-left"]').text(`${Math.max(0, carbsGoalGrams - macroData.carbs).toFixed(1)} g`); const fatGoalGrams = parseFloat($('[data-value="fat-goal"]').text().replace(/[^0-9.]/g, '')) || 0; $('[data-value="fat-left"]').text(`${Math.max(0, fatGoalGrams - macroData.fat).toFixed(1)} g`); const totalMacroCalories = (macroData.carbs * 4) + (macroData.fat * 9) + (macroData.protein * 4); const carbsPercent = totalMacroCalories > 0 ? Math.round((macroData.carbs * 4 / totalMacroCalories) * 100) : 0; const fatPercent = totalMacroCalories > 0 ? Math.round((macroData.fat * 9 / totalMacroCalories) * 100) : 0; let proteinPercent = 0; if (totalMacroCalories > 0) { proteinPercent = 100 - carbsPercent - fatPercent; if (proteinPercent < 0) proteinPercent = 0; } $('[data-value="carbs-grams"]').text(`${macroData.carbs.toFixed(1)}g`); $('[data-value="carbs-percentage"]').text(`${carbsPercent}%`); $('[data-value="fat-grams"]').text(`${macroData.fat.toFixed(1)}g`); $('[data-value="fat-percentage"]').text(`${fatPercent}%`); $('[data-value="protein-grams"]').text(`${macroData.protein.toFixed(1)}g`); $('[data-value="protein-percentage"]').text(`${proteinPercent}%`); }
            function initializeOrUpdateNutritionCharts(calorieDataToDisplay = currentCalorieData, macroDataToDisplay = currentMacroData) { updateNutritionUI(calorieDataToDisplay, macroDataToDisplay); const calorieCtx = document.getElementById('calorieChart'); if (calorieCtx) { if (calorieChartInstance) calorieChartInstance.destroy(); calorieChartInstance = new Chart(calorieCtx.getContext('2d'), { type: 'doughnut', data: { labels: ['Breakfast', 'Lunch', 'Dinner', 'Snacks'], datasets: [{ label: 'Calories', data: [calorieDataToDisplay.breakfast, calorieDataToDisplay.lunch, calorieDataToDisplay.dinner, calorieDataToDisplay.snacks], backgroundColor: ['#bf9a33', '#febd14', '#fece43', '#feda75'], borderColor: 'var(--card-bg)', borderWidth: 3 }] }, options: { responsive: true, maintainAspectRatio: false, cutout: '60%', plugins: { legend: { display: false }, tooltip: { callbacks: { label: c => { let l = c.label || ''; if (l) l += ': '; if (c.parsed !== null) l += c.parsed.toLocaleString() + ' cal'; return l; } }, titleColor: 'var(--main-color)', bodyColor: 'var(--card-text-color)', backgroundColor: 'var(--card-bg)', borderColor: 'var(--main-color)', borderWidth: 1 } } } }); } const macroCtx = document.getElementById('macroChart'); if (macroCtx) { if (macroChartInstance) macroChartInstance.destroy(); const totalMacroCalories = (macroDataToDisplay.carbs * 4) + (macroDataToDisplay.fat * 9) + (macroDataToDisplay.protein * 4); macroChartInstance = new Chart(macroCtx.getContext('2d'), { type: 'doughnut', data: { labels: ['Carbohydrates', 'Fat', 'Protein'], datasets: [{ label: 'Macronutrients (Calories)', data: [macroDataToDisplay.carbs * 4, macroDataToDisplay.fat * 9, macroDataToDisplay.protein * 4], backgroundColor: ['#febd14', '#fece43', '#feda75'], borderColor: 'var(--card-bg)', borderWidth: 3 }] }, options: { responsive: true, maintainAspectRatio: false, cutout: '60%', plugins: { legend: { display: false }, tooltip: { callbacks: { label: c => { let l = c.label || ''; let calVal = c.parsed || 0; let gVal = 0; if (l === 'Carbohydrates') gVal = macroDataToDisplay.carbs; else if (l === 'Fat') gVal = macroDataToDisplay.fat; else if (l === 'Protein') gVal = macroDataToDisplay.protein; let perc = totalMacroCalories > 0 ? Math.round((calVal / totalMacroCalories) * 100) : 0; if (l) l += ': '; l += gVal.toLocaleString(undefined, {minimumFractionDigits:1, maximumFractionDigits:1}) + 'g (' + perc + '%)'; return l; } }, titleColor: 'var(--main-color)', bodyColor: 'var(--card-text-color)', backgroundColor: 'var(--card-bg)', borderColor: 'var(--main-color)', borderWidth: 1 } } } }); } }

            $('.add-food-item-btn').on('click', function() { const $form = $(this).closest('.food-item-entry-form'); const mealType = $(this).data('meal'); const foodName = $form.find('.food-name').val().trim(); const calories = parseFloat($form.find('.food-calories').val()) || 0; const protein = parseFloat($form.find('.food-protein').val()) || 0; const carbs = parseFloat($form.find('.food-carbs').val()) || 0; const fat = parseFloat($form.find('.food-fat').val()) || 0; if (foodName && calories > 0) { const $list = $(`.logged-food-list.${mealType}-list`); const listItem = $(`<li><span>${foodName} - ${calories} Cals, ${protein.toFixed(1)}P, ${carbs.toFixed(1)}C, ${fat.toFixed(1)}F</span> <i class='bx bx-x remove-food-item' title='Remove item'></i></li>`).data({foodName, calories, protein, carbs, fat}); $list.append(listItem); $form.find('input[type="text"], input[type="number"]').val(''); $('#updateNutritionSummaryBtn').trigger('click'); } else { alert("Please enter at least food name and calories."); } });
            $('.meal-logging-section').on('click', '.remove-food-item', function() { $(this).closest('li').remove(); $('#updateNutritionSummaryBtn').trigger('click'); });
            $('#updateNutritionSummaryBtn').on('click', function() { let newCalorieData = { breakfast: 0, lunch: 0, dinner: 0, snacks: 0 }; let newMacroData = { carbs: 0, fat: 0, protein: 0 }; $('.logged-food-list li').each(function() { const $li = $(this); const mealType = $li.parent().attr('class').split(' ')[1].split('-')[0]; newCalorieData[mealType] += $li.data('calories') || 0; newMacroData.protein += $li.data('protein') || 0; newMacroData.carbs += $li.data('carbs') || 0; newMacroData.fat += $li.data('fat') || 0; }); currentCalorieData = newCalorieData; currentMacroData = newMacroData; initializeOrUpdateNutritionCharts(currentCalorieData, currentMacroData); });
            $('#addExerciseToLogBtn').on('click', function() { const exerciseName = $('#logExerciseName').val().trim(); const sets = $('#logSets').val(); const reps = $('#logReps').val(); const weight = $('#logWeight').val(); const duration = $('#logDuration').val(); const notes = $('#logExerciseNotes').val().trim(); if (!exerciseName) { alert("Please enter an Exercise Name."); return; } const selectedDateStr = getSelectedDateString(); const newRowHtml = `<tr><td data-label="Date" class="date-col">${selectedDateStr}</td><td data-label="Exercise">${exerciseName}</td><td data-label="Sets">${sets || '-'}</td><td data-label="Reps">${reps || '-'}</td><td data-label="Weight">${weight || '-'}</td><td data-label="Duration">${duration || '-'}</td><td data-label="Notes" class="notes-cell">${notes || ''}</td></tr>`; $('.workout-table tbody').append(newRowHtml); $('#logExerciseName, #logSets, #logReps, #logWeight, #logDuration, #logExerciseNotes').val(''); alert(`"${exerciseName}" added to the log for ${selectedDateStr}.`); });
            $('#saveFullLogBtn').on('click', function() { alert("Notes Saved! (Demo - Data is not actually saved)"); });
            $('#submitCoachFeedbackBtn, #submitCoachFeedbackBtn_nutrition').on('click', function() { alert("Feedback Submitted! (Demo - Data is not actually saved)"); $('#coachComment, #coachComment_nutrition').val(''); });
            $('#subscribeForm').on('submit', function(e) { e.preventDefault(); const email = $('#subscribeEmail').val(); alert(`Subscribed with ${email}! (Demo)`); $('#subscribeEmail').val(''); });
            function getSelectedDateString() { const selectedDateVal = $('.calendar-grid .date-cell button.selected').data('date'); if (selectedDateVal) { return moment(selectedDateVal).format("MMM D, YYYY"); } return moment().format("MMM D, YYYY"); }
            function updateMealLogDateTitle() { const formattedDate = getSelectedDateString(); $('#selectedDateForMealLog').text(formattedDate); }
            updateMealLogDateTitle();
            $('.calendar-grid .date-cell button').on('click', function() { if(!$(this).parent().hasClass('empty')) { $('.calendar-grid .date-cell button').removeClass('selected'); $(this).addClass('selected'); updateMealLogDateTitle(); $('.logged-food-list').empty(); currentCalorieData = { breakfast: 0, lunch: 0, dinner: 0, snacks: 0 }; currentMacroData = { carbs: 0, fat: 0, protein: 0 }; initializeOrUpdateNutritionCharts(); } });
             $('.cal-nav').on('click', function() { setTimeout(() => { const firstAvailableDateButton = $('.calendar-grid .date-cell button:not(:disabled)').first(); if(firstAvailableDateButton.length && !$('.calendar-grid .date-cell button.selected').length) { firstAvailableDateButton.addClass('selected'); } updateMealLogDateTitle(); $('.logged-food-list').empty(); currentCalorieData = { breakfast: 0, lunch: 0, dinner: 0, snacks: 0 }; currentMacroData = { carbs: 0, fat: 0, protein: 0 }; initializeOrUpdateNutritionCharts(); }, 100); });

            if ($('#tabs-1').hasClass('active')) { } else if ($('#tabs-2').hasClass('active')) { initializeOrUpdateProgressChart(); } else if ($('#tabs-3').hasClass('active')) { const activeNutritionButton = $('#tabs-3 .tabs .tab-button.active'); if (activeNutritionButton.length) { const targetNutritionTab = activeNutritionButton.data('tab'); $('#tabs-3 .nutrition-tab-content').removeClass('active'); $('#' + targetNutritionTab + '-content').addClass('active'); } else { $('#calories-content').addClass('active'); } initializeOrUpdateNutritionCharts(); }

            function loadUserName() { let userName = "Han Soyoung"; $('#header-user-name').text(userName); }
            loadUserName();
        });
    </script>

</body>
</html>